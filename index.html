<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="陈功的小博客">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="陈功的小博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Long Chen">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>陈功的小博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">陈功的小博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/20/020Drep-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/20/020Drep-notes/" class="post-title-link" itemprop="url">drep：基因组的快速比较和去复制</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-20 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-20T09:25:00+08:00">2022-05-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:36" itemprop="dateModified" datetime="2023-03-23T21:51:36+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84/" itemprop="url" rel="index"><span itemprop="name">宏基因组</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="MrOlm-x2F-drep-Rapid-comparison-and-dereplication-of-genomes"><a href="#MrOlm-x2F-drep-Rapid-comparison-and-dereplication-of-genomes" class="headerlink" title="MrOlm&#x2F;drep: Rapid comparison and dereplication of genomes"></a><a target="_blank" rel="noopener" href="https://github.com/MrOlm/drep">MrOlm&#x2F;drep: Rapid comparison and dereplication of genomes</a></h2><p>推荐用conda安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda create -n drep</span><br><span class="line">conda activate drep</span><br><span class="line">conda install drep -c bioconda</span><br></pre></td></tr></table></figure>

<p>也可以用pip，但是有一些依赖的包可能需要自己下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install drep</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908759.png" alt="image-20220506151828537"></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908166.png" alt="image-20220506151949260"></p>
<p>安装版本V3.2.2</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/Go24oNyJFdPiXLTyCeLL1g">drep：微生物基因组快速去冗余-文章解读+帮助文档+实战教程</a></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908821.png" alt="image-20220506162420047"></p>
<h1 id="1-dRep需要依赖一些软件"><a href="#1-dRep需要依赖一些软件" class="headerlink" title="1. dRep需要依赖一些软件"></a>1. dRep需要依赖一些软件</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">运行</span><br><span class="line">$ dRep check_dependencies</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mash.................................... !!! ERROR !!!   (location = None)</span><br><span class="line">nucmer.................................. !!! ERROR !!!   (location = None)</span><br><span class="line">checkm.................................. all good        (location = </span><br><span class="line">ANIcalculator........................... !!! ERROR !!!   (location = None)</span><br><span class="line">prodigal................................ all good        (location = /usr/bin/prodigal)</span><br><span class="line">centrifuge.............................. !!! ERROR !!!   (location = None)</span><br><span class="line">nsimscan................................ !!! ERROR !!!   (location = None)</span><br><span class="line">fastANI................................. !!! ERROR !!!   (location = None）</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908955.png" alt="image-20220509154537123"></p>
<p>这两个是必须的</p>
<p>可以单独安装，也可以让conda安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这两个应该都行</span><br><span class="line">conda install -c bioconda mash</span><br><span class="line">conda install -c bioconda/label/cf201901 mash</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda install -c bioconda mummer</span><br><span class="line">conda install -c bioconda/label/cf201901 mummer</span><br></pre></td></tr></table></figure>



<h3 id="mash的安装"><a href="#mash的安装" class="headerlink" title="mash的安装"></a>mash的安装</h3><p><a target="_blank" rel="noopener" href="https://genomebiology.biomedcentral.com/articles/10.1186/s13059-016-0997-x">Mash: fast genome and metagenome distance estimation using MinHash | Genome Biology | Full Text</a><br><a target="_blank" rel="noopener" href="https://github.com/marbl/mash">marbl&#x2F;Mash: Fast genome and metagenome distance estimation using MinHash</a><br><a target="_blank" rel="noopener" href="https://github.com/marbl/Mash/releases/tag/v2.3">Release Mash v2.3 · marbl&#x2F;Mash</a></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908913.png" alt="image-20220507233706093"></p>
<p>下载之后，安装就ok了</p>
<h3 id="nucmer的安装"><a href="#nucmer的安装" class="headerlink" title="nucmer的安装"></a>nucmer的安装</h3><p><a target="_blank" rel="noopener" href="http://mummer.sourceforge.net/">The MUMmer Home Page</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/mummer4/mummer">mummer4&#x2F;mummer: Mummer alignment tool</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/mummer4/mummer/blob/master/INSTALL.md">mummer&#x2F;INSTALL.md at master · mummer4&#x2F;mummer</a></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908599.png" alt="image-20220507234520479"></p>
<p>然后</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908787.png" alt="image-20220509154629191"></p>
<p>这些是可选的</p>
<p>我下centrifuge的时候，发现我的版本可能高了，不适配了</p>
<p>不用都下，用不到就先不下，报错了再下也不迟</p>
<h1 id="2-实战"><a href="#2-实战" class="headerlink" title="2. 实战"></a>2. 实战</h1><h3 id="Try1"><a href="#Try1" class="headerlink" title="Try1"></a>Try1</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">##模拟数据来源刘永鑫</span><br><span class="line">(drep) chenl 16:32:14 ~/drep_try/fa</span><br><span class="line">$ ls</span><br><span class="line">B4018L.2.fa  K4093L.5.fa  K4096L.2.fa  L4105L.2.fa  W4194L.3.fa  W4194L.6.fa</span><br><span class="line">$ dRep dereplicate out1 -g ./fa/*.fa</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908283.png" alt="image-20220509172353844"></p>
<p>checkm的时间比较久，然后啪叽就成功了</p>
<p>Succeed:happy:</p>
<h3 id="Try2"><a href="#Try2" class="headerlink" title="Try2"></a>Try2</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dRep dereplicate ./ -g bin/*.fa -sa 0.95 -nc 0.30 -p 24 -comp 50 -con 10</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> -sa S_ANI, --S_ani S_ANI</span><br><span class="line">                       二级聚类为99% ANI threshold to form secondary clusters (default:</span><br><span class="line">                       0.99)</span><br><span class="line"> -nc COV_THRESH, --cov_thresh COV_THRESH</span><br><span class="line">                       最小的重叠是10% Minmum level of overlap between genomes when doing</span><br><span class="line">                       secondary comparisons (default: 0.1)</span><br><span class="line">- p 线程</span><br><span class="line">- comp 完整度</span><br><span class="line">- 污染度</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908193.png" alt="image-20220509231153634"></p>
<h3 id="Try3"><a href="#Try3" class="headerlink" title="Try3"></a>Try3</h3><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908755.png" alt="image-20220509231307632"></p>
<h1 id="3-结果"><a href="#3-结果" class="headerlink" title="3. 结果"></a>3. 结果</h1><h2 id="Cluster-scoring"><a href="#Cluster-scoring" class="headerlink" title="Cluster_scoring"></a>Cluster_scoring</h2><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908631.png" alt="image-20220510102806936"></p>
<h2 id="Clustering-scatterplots"><a href="#Clustering-scatterplots" class="headerlink" title="Clustering_scatterplots"></a>Clustering_scatterplots</h2><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908568.png" alt="image-20220510102904210"></p>
<h2 id="Primary-clustering-dendrogram"><a href="#Primary-clustering-dendrogram" class="headerlink" title="Primary_clustering_dendrogram"></a>Primary_clustering_dendrogram</h2><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908246.png" alt="image-20220510102940514"></p>
<h2 id="Secondary-clustering-dendrograms"><a href="#Secondary-clustering-dendrograms" class="headerlink" title="Secondary_clustering_dendrograms"></a>Secondary_clustering_dendrograms</h2><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131908510.png" alt="image-20220510103012175"></p>
<h2 id="Secondary-clustering-MDS"><a href="#Secondary-clustering-MDS" class="headerlink" title="Secondary_clustering_MDS"></a>Secondary_clustering_MDS</h2><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131907590.png" alt="image-20220510103100252"></p>
<h2 id="Winning-genomes"><a href="#Winning-genomes" class="headerlink" title="Winning_genomes"></a>Winning_genomes</h2><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131907299.png" alt="image-20220510103131052"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/19/019Checkm-practice/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/19/019Checkm-practice/" class="post-title-link" itemprop="url">Checkm操作试验</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-19 07:25:00" itemprop="dateCreated datePublished" datetime="2022-05-19T07:25:00+08:00">2022-05-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:34" itemprop="dateModified" datetime="2023-03-23T21:51:34+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84/" itemprop="url" rel="index"><span itemprop="name">宏基因组</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Checkm"><a href="#Checkm" class="headerlink" title="Checkm"></a>Checkm</h1><h2 id="lineage-specific（世系特异性）-x3D-x3D-【推荐方法】-x3D-x3D"><a href="#lineage-specific（世系特异性）-x3D-x3D-【推荐方法】-x3D-x3D" class="headerlink" title="lineage-specific（世系特异性）&#x3D;&#x3D;【推荐方法】&#x3D;&#x3D;"></a>lineage-specific（世系特异性）&#x3D;&#x3D;【推荐方法】&#x3D;&#x3D;</h2><p>lineage-specific（世系特异性）（使用该方法需下载checkM的参考数据集，并设置安装在相应位置）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">##下载数据库，并解压设置路径</span><br><span class="line">wget -c https://data.ace.uq.edu.au/public/CheckM_databases/checkm_data_2015_01_16.tar.gz</span><br><span class="line">tar -zxvf checkm_data_2015_01_16.tar.gz</span><br><span class="line">checkm data setRoot $PATH/checkm_data</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#####我的指令</span><br><span class="line">checkm lineage_wf -t 46 -x fa --nt --tab_table -f /home/chenl/RA/BGI/assembly/RAH26A/bin_qa_result/RAH26A_bins_qa.txt /home/chenl/RA/BGI/assembly/RAH26A/bin /home/chenl/RA/BGI/assembly/RAH26A/bin_qa_result</span><br></pre></td></tr></table></figure>

<p>（题外话：中间会用到pplacer，这一步也可以设置线程数，默认是1）</p>
<h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>得到bins_qa.txt</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131930085.png" alt="image-20220420151150554">关键点：BIn Id（唯一的)、completeness（完整度)、Contamination（污染度)</p>
<h5 id="得到的结果是一个样本的所有bin，现在需要分析所有样本，就需要把所有样本整合到一起，那就是Python脚本，我自己上网随便搜的一个。"><a href="#得到的结果是一个样本的所有bin，现在需要分析所有样本，就需要把所有样本整合到一起，那就是Python脚本，我自己上网随便搜的一个。" class="headerlink" title="得到的结果是一个样本的所有bin，现在需要分析所有样本，就需要把所有样本整合到一起，那就是Python脚本，我自己上网随便搜的一个。"></a>得到的结果是一个样本的所有bin，现在需要分析所有样本，就需要把所有样本整合到一起，那就是Python脚本，我自己上网随便搜的一个。</h5><p>整合之后就是一个含有所有bins的污染度和完整度信息，就可以画图了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/18/018CheckM-Options-ch-zn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/18/018CheckM-Options-ch-zn/" class="post-title-link" itemprop="url">Checkm操作实战</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-18 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-18T09:25:00+08:00">2022-05-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:33" itemprop="dateModified" datetime="2023-03-23T21:51:33+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84/" itemprop="url" rel="index"><span itemprop="name">宏基因组</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Ecogenomics/CheckM">CheckM的GitHub官网</a></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Ecogenomics/CheckM/wiki">CheckM英文帮助文档</a></p>
</blockquote>
<blockquote>
<p>参考链接</p>
<p><a target="_blank" rel="noopener" href="http://www.mselab.cn/detail/81/">CheckM (宏)基因组质量评估</a></p>
<p><a target="_blank" rel="noopener" href="https://nmdc.cn/analyze/details?id=60063a780b38496ee0c908b0">国家微生物科学数据中心-CheckM使用说明</a>内有视频及PDF讲解，还可线上测试。</p>
</blockquote>
<p>参考微信公众号宏基因组文章</p>
<h1 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h1><p>CheckM首先基于完整的已测序细菌基因组作为参考基因组，构建基因组的进化树，构建每个谱系（可以理解为一类物种）的单拷贝基因集（管家基因）（single copy genes，SCGs，为什么是单拷贝？因为这样可以开展基因组混合程度、污染程度等的评估）。在使用时，将我们的Bin与参考基因组一起建树，基于进化关系找到Bin的参考物种，然后结合参考物种的单拷贝基因集，计算两个重要指标</p>
<p>Completeness，完整度，Bin基因与对应SCGs相比，基因数量是否完整，取值[0,100%]，数值越大，表示Bin质量越好； Contamination，污染度，Bin基因包含多个物种的SCGs，即一个Bin存在多个物种的程度，取值[0,100%]，数值越小，表示Bin质量越好。</p>
<p>获得每个bin的污染度、完整度信息后，挑选高质量的bin进行物种、功能注释。再后续分析中，并没有固定标准。需要的数量多，则放宽阈值；需要的数量少，则提升阈值。其中，最常用的指标是污染度小于10%，且完整度大于80%。大家可以在这个基础上上下调整。</p>
<blockquote>
<p>得到了组装的bin的数据，CheckM下载完成，开始分析</p>
</blockquote>
<h1 id="CheckM的工作流程"><a href="#CheckM的工作流程" class="headerlink" title="CheckM的工作流程"></a>CheckM的工作流程</h1><p>lineage-specific（世系特异性）&#x3D;&#x3D;【推荐方法】&#x3D;&#x3D;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">checkm lineage_wf &lt;bin folder&gt; &lt;output folder&gt;</span><br><span class="line">##根据基因组在参考基因组发育树中的位置，来推断它的single-copy基因集，需要有checkM的数据库</span><br></pre></td></tr></table></figure>

<p>taxonomic-specific（物种分类特异性）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">checkm taxonomy_wf &lt;rank&gt; &lt;taxon&gt; &lt;bin folder&gt; &lt;output folder&gt; &lt;rank&gt;: phylum; &lt;taxon&gt; : Cyanobacteria</span><br><span class="line">##自己知道自己的数据来自哪个门，什么科的</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>custom marker genes（自行指定基因maker）</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">checkm analyze &lt;custom HMM file&gt; &lt;bin folder&gt; &lt;output folder&gt;</span><br><span class="line">checkm qa &lt;custom HMM file&gt; &lt;output folder&gt;</span><br><span class="line">##自己预测了基因maker，&lt;custom HMM file&gt;就是预测的结果</span><br></pre></td></tr></table></figure>

<h1 id="【推荐方法】"><a href="#【推荐方法】" class="headerlink" title="【推荐方法】"></a>【推荐方法】</h1><p>lineage-specific（世系特异性）（使用该方法需下载checkM的参考数据集，并设置安装在相应位置）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">##下载数据库，并解压设置路径</span><br><span class="line">wget -c https://data.ace.uq.edu.au/public/CheckM_databases/checkm_data_2015_01_16.tar.gz</span><br><span class="line">tar -zxvf checkm_data_2015_01_16.tar.gz</span><br><span class="line">checkm data setRoot $PATH/checkm_data</span><br></pre></td></tr></table></figure>





<p>&#x3D;&#x3D;主要操作命令&#x3D;&#x3D;</p>
<h2 id="checkm-lineage-wf-h的详细参数-主要用这个"><a href="#checkm-lineage-wf-h的详细参数-主要用这个" class="headerlink" title="checkm lineage_wf -h的详细参数(主要用这个)"></a>checkm lineage_wf -h的详细参数(主要用这个)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">$ checkm lineage_wf -h</span><br><span class="line">usage: checkm lineage_wf [-h] [-r] [--ali] [--nt] [-g] [-u UNIQUE] [-m MULTI]</span><br><span class="line">                         [--force_domain] [--no_refinement]</span><br><span class="line">                         [--individual_markers] [--skip_adj_correction]</span><br><span class="line">                         [--skip_pseudogene_correction]</span><br><span class="line">                         [--aai_strain AAI_STRAIN] [-a ALIGNMENT_FILE]</span><br><span class="line">                         [--ignore_thresholds] [-e E_VALUE] [-l LENGTH]</span><br><span class="line">                         [-f FILE] [--tab_table] [-x EXTENSION] [-t THREADS]</span><br><span class="line">                         [--pplacer_threads PPLACER_THREADS] [-q]</span><br><span class="line">                         [--tmpdir TMPDIR]</span><br><span class="line">                         bin_dir output_dir</span><br><span class="line"></span><br><span class="line">Runs tree, lineage_set, analyze, qa #跑tree、lineage_set、analyze、qa这四个操作</span><br><span class="line"></span><br><span class="line">positional arguments:##位置参数</span><br><span class="line">  bin_dir               directory containing bins (fasta format)###你组装得到bin的目录</span><br><span class="line">  output_dir            directory to write output files##写入输出文件的目录</span><br><span class="line"></span><br><span class="line">optional arguments:##可选参数</span><br><span class="line">  -h, --help            show this help message and exit##就是我不了解参数，救命</span><br><span class="line">  -r, --reduced_tree    use reduced tree (requires &lt;16GB of memory) for determining lineage of each bin##使用精简树(需要小于16 GB的内存)来确定每个箱的谱系</span><br><span class="line">  --ali                 generate HMMER alignment file for each bin##为每个条柱生成HMMER对齐文件</span><br><span class="line">  --nt                  generate nucleotide gene sequences for each bin##为每个bin生成核苷酸基因序列</span><br><span class="line">  -g, --genes           bins contain genes as amino acids instead of nucleotide contigs##bin中含有氨基酸而不是核苷酸重叠群的基因</span><br><span class="line">  -u, --unique UNIQUE   minimum number of unique phylogenetic markers required to use lineage-specific marker set (default: 10)##使用谱系特定标记集所需的唯一系统发育标记的最小数量(默认值：10)</span><br><span class="line">  -m, --multi MULTI     maximum number of multi-copy phylogenetic markers before defaulting to domain-level marker set (default: 10)##默认设置为域级标记集之前的多拷贝系统发育标记的最大数量(默认值：10)</span><br><span class="line">  --force_domain        use domain-level sets for all bins##对所有bin使用域级别集</span><br><span class="line">  --no_refinement       do not perform lineage-specific marker set refinement##不执行特定于谱系的标记集细化</span><br><span class="line">  --individual_markers  treat marker as independent (i.e., ignore co-located set structure)##将标记视为独立的（即忽略共存的集合结构）</span><br><span class="line">  --skip_adj_correction</span><br><span class="line">                        do not exclude adjacent marker genes when estimating contamination##在估计污染时不排除相邻的标记基因</span><br><span class="line">  --skip_pseudogene_correction</span><br><span class="line">                        skip identification and filtering of pseudogenes##假基因的跳跃识别与过滤</span><br><span class="line">  --aai_strain AAI_STRAIN</span><br><span class="line">                        AAI threshold used to identify strain heterogeneity (default: 0.9)##用于识别菌株异质性的AAI阈值(默认值：0.9)</span><br><span class="line">  -a, --alignment_file ALIGNMENT_FILE</span><br><span class="line">                        produce file showing alignment of multi-copy genes and their AAI identity##生成显示多拷贝基因的比对及其AAI身份的文件</span><br><span class="line">  --ignore_thresholds   ignore model-specific score thresholds##忽略特定于型号的分数阈值</span><br><span class="line">  -e, --e_value E_VALUE</span><br><span class="line">                        e-value cut off (default: 1e-10)##E值截止(默认：1e-10)</span><br><span class="line">  -l, --length LENGTH   percent overlap between target and query (default: 0.7)##目标和查询之间的重叠百分比(默认值：0.7)</span><br><span class="line">  -f, --file FILE       print results to file (default: stdout)##将结果打印到文件（默认：stdout）</span><br><span class="line">  --tab_table           print tab-separated values table##打印制表符分隔的值表</span><br><span class="line">  -x, --extension EXTENSION</span><br><span class="line">                        extension of bins (other files in directory are ignored) (default: fna)##Bin的扩展名(忽略目录中的其他文件)(默认：FNA)</span><br><span class="line">  -t, --threads THREADS</span><br><span class="line">                        number of threads (default: 1)##线程数(默认为1)</span><br><span class="line">  --pplacer_threads PPLACER_THREADS</span><br><span class="line">                        number of threads used by pplacer (memory usage increases linearly with additional threads) (default: 1)##Pplacer使用的线程数(内存使用量随着线程的增加而线性增加)(默认值：1)</span><br><span class="line">  -q, --quiet           suppress console output##抑制控制台输出</span><br><span class="line">  --tmpdir TMPDIR       specify an alternative directory for temporary files##为临时文件指定替代目录</span><br><span class="line"></span><br><span class="line">Example: checkm lineage_wf ./bins ./output</span><br></pre></td></tr></table></figure>

<p>checkm的所有参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">usage: checkm</span><br><span class="line">              &#123;data,tree,tree_qa,lineage_set,taxon_list,taxon_set,analyze,qa,lineage_wf,taxonomy_wf,gc_plot,coding_plot,tetra_plot,dist_plot,gc_bias_plot,nx_plot,len_hist,marker_plot,unbinned,coverage,tetra,profile,ssu_finder,merge,outliers,modify,unique,test&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Overview一般不需要用到这块"><a href="#Overview一般不需要用到这块" class="headerlink" title="Overview一般不需要用到这块"></a>Overview一般不需要用到这块</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Overview</span><br><span class="line">Lineage-specific marker set##谱系特定的标记集</span><br><span class="line">tree: place bins in the reference genome tree##把bins放到参考基因组树中</span><br><span class="line">tree_qa: assess phylogenetic markers found in each bin##评估在每个bin中发现的系统发育标记</span><br><span class="line">lineage_set: infer lineage-specific marker sets for each bin##为每个仓位推断特定于谱系的标记集</span><br><span class="line"></span><br><span class="line">Taxonomic-specific marker set##特定于分类的标记集</span><br><span class="line">taxon_list: list available taxonomic-specific marker sets##列出可用的特定于分类的标记集</span><br><span class="line">taxon_set: infer taxonomic-specific marker set##推断特定于分类的标记集</span><br><span class="line"></span><br><span class="line">Apply marker set to genome bins##将标记集应用于基因组bins</span><br><span class="line">analyze: identify marker genes in bins##识别bins中的标记基因</span><br><span class="line">qa: assess bins for contamination and completeness##评估bins的污染性和完整</span><br></pre></td></tr></table></figure>

<h5 id="unbinned"><a href="#unbinned" class="headerlink" title="unbinned"></a>unbinned</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">usage: checkm unbinned [-h] [-x EXTENSION] [-s MIN_SEQ_LEN] [-q]</span><br><span class="line">                       bin_dir seq_file output_seq_file output_stats_file</span><br><span class="line">Example: checkm unbinned ./bins seqs.fna unbinned.fna unbinned_stats.tsv</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">实战</span><br><span class="line">(py37) [chenl@cpu3 ~/textcheckm/radata]$ checkm unbinned -x fa /home/chenl/textcheckm/SRR5091453/bin /home/chenl/textcheckm/radata/SRR5091453_1_paired.fasta checkm-unbinned.txt checkm-unbinned-stats.txt</span><br><span class="line">##</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131933531.png" alt="image-20220406185757519"></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131933638.png" alt="image-20220406185819763"></p>
<h5 id="coverage"><a href="#coverage" class="headerlink" title="coverage"></a>coverage</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">usage: checkm coverage [-h] [-x EXTENSION] [-r] [-a MIN_ALIGN]</span><br><span class="line">                       [-e MAX_EDIT_DIST] [-m MIN_QC] [-t THREADS] [-q]</span><br><span class="line">                       bin_dir output_file bam_files [bam_files ...]</span><br><span class="line">Example: checkm coverage ./bins coverage.tsv example_1.bam example_2.bam</span><br></pre></td></tr></table></figure>

<h5 id="tetra"><a href="#tetra" class="headerlink" title="tetra"></a>tetra</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">usage: checkm tetra [-h] [-t THREADS] [-q] seq_file output_file</span><br><span class="line">Example: checkm tetra seqs.fna tetra.tsv</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">实战</span><br><span class="line">(py37) [chenl@cpu3 ~/textcheckm/radata]$ checkm tetra SRR5091453_1_paired.fasta SRR5091453-tetra.tsv</span><br><span class="line">##结果</span><br><span class="line">生成 SRR5091453-tetra.tsv</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131933558.png" alt="image-20220406191115228"></p>
<h5 id="profile"><a href="#profile" class="headerlink" title="profile"></a>profile</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">usage: checkm profile [-h] [-f FILE] [--tab_table] [-q] coverage_file</span><br><span class="line">Example: checkm profile coverage.tsv</span><br></pre></td></tr></table></figure>

<h5 id="gc-plot-create-GC-histogram-and-delta-GC-plot"><a href="#gc-plot-create-GC-histogram-and-delta-GC-plot" class="headerlink" title="gc_plot: create GC histogram and delta-GC plot"></a>gc_plot: create GC histogram and delta-GC plot</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">usage: checkm gc_plot [-h] [--image_type &#123;eps,pdf,png,ps,svg&#125;] [--dpi DPI]</span><br><span class="line">                      [--font_size FONT_SIZE] [-x EXTENSION] [--width WIDTH]</span><br><span class="line">                      [--height HEIGHT] [-w GC_WINDOW_SIZE] [-b GC_BIN_WIDTH]</span><br><span class="line">                      [-q]</span><br><span class="line">                      bin_dir output_dir dist_value [dist_value ...]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">##实战##有的参数没设置，dist_value随便设置的</span><br><span class="line">checkm gc_plot --image_type pdf -x fa /home/chenl/textcheckm/SRR5091453/bin SRR5091453-gc_plot 50</span><br><span class="line">##结果</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131933242.png" alt="image-20220408153324312"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/17/017Binning-METABAT2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/017Binning-METABAT2/" class="post-title-link" itemprop="url">分箱Binning-MetaBAT2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-17 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-17T09:25:00+08:00">2022-05-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:33" itemprop="dateModified" datetime="2023-03-23T21:51:33+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84/" itemprop="url" rel="index"><span itemprop="name">宏基因组</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>:runner:以下均为我<strong>个人</strong>在宏基因组学习过程中的笔记，参考性不大,参考链接很靠谱。:raising_hand:</p>
<p>有什么想找的请直接Ctrl + F （我写的很乱）:smiley_cat:</p>
</blockquote>
<blockquote>
<p>下面:runner:这些链接是我在学习中的参考文章</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/66ab14988a74">https://www.jianshu.com/p/66ab14988a74</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/54080691">https://zhuanlan.zhihu.com/p/54080691</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/64607571">https://zhuanlan.zhihu.com/p/64607571</a></p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/BHCs2Y97jXL-2kInlu49UA">https://mp.weixin.qq.com/s/BHCs2Y97jXL-2kInlu49UA</a></p>
</blockquote>
<h1 id="分箱Binning-MetaBAT2"><a href="#分箱Binning-MetaBAT2" class="headerlink" title="分箱Binning-MetaBAT2"></a>分箱Binning-MetaBAT2</h1><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131935933.png" alt="image-20220331153743110"></p>
<p>宏基因组分箱（Binning）是将宏基因组测序得到的混合了不同生物的序列或序列组装得到的<strong>contigs</strong>按&#x3D;&#x3D;物种分开归类&#x3D;&#x3D;的过程，类似下图。传统的单物种全基因组序列都是经纯培养之后，再进行全基因组de novo测序才获得的，但是环境中存在着大量的不可培养微生物，宏基因组分箱技术有助于<strong>获得不可培养微生物的全基因组序列</strong>，获得新物种的基因组&#x3D;&#x3D;序列和功能&#x3D;&#x3D;，预测未知物种的培养方法等等。</p>
<p><strong>关联分析</strong></p>
<p>即通过binning得到的bins（暂且简称为bins，更确切的说是strain-level clusters 或strain-level taxonomic units）可以进行宏基因组关联分析以及多组学联合分析，将特定功能代谢产物与特定物种、特定基因进行关联研究，推动其因果机制的探究，为疾病监控、环境监测提供了菌株水平的生物靶标</p>
<p><strong>单菌组装</strong></p>
<p>通过对binning得到的bins进行后续组装，可以得到很多不能在实验室里培养的细菌、古菌、病毒的基因组草图，然后根据单菌组装结果进行菌株水平的基因和功能注释、比较基因组分析、进化分析等，使我们得以洞察这些无法在实验室培养获得的菌株的生态适应机制，营养互作机制和新陈代谢功能等，可以研究在生态环境和复杂疾病中起重要作用的菌种以及致病菌和宿主的互作机制及其微进化机制。</p>
<h2 id="工具选择：MetaBAT2（2022年3月）"><a href="#工具选择：MetaBAT2（2022年3月）" class="headerlink" title="工具选择：MetaBAT2（2022年3月）"></a>工具选择：MetaBAT2（2022年3月）</h2><p>MetaBAT2 <a target="_blank" rel="noopener" href="https://scholar.google.com/scholar?cites=12807292371087613086&as_sdt=2005&sciodt=0,5&hl=zh-CN">被引用次数：602</a>        MetaBAT2在单样本分箱中表现最佳</p>
<p><strong>PeerJ  2019最好</strong><br>MetaWRAP <a target="_blank" rel="noopener" href="https://scholar.google.com/scholar?cites=17296056393600541986&as_sdt=2005&sciodt=0,5&hl=zh-CN">被引用次数：413</a>       </p>
<p>MetaBAT <a target="_blank" rel="noopener" href="https://scholar.google.com/scholar?cites=14563814112204661553&as_sdt=2005&sciodt=0,5&hl=zh-CN">被引用次数：1151</a></p>
<p><strong>PeerJ</strong>CONCOCT <a target="_blank" rel="noopener" href="https://scholar.google.com/scholar?cites=10199958528531741910&as_sdt=2005&sciodt=0,5&hl=zh-CN">被引用次数：60</a>   能获得最多的bin</p>
<p><a target="_blank" rel="noopener" href="https://scholar.google.com/scholar?cluster=2120866697955990770&hl=zh-CN&as_sdt=2005&sciodt=0,5">MaxBin 2.0</a><a target="_blank" rel="noopener" href="https://scholar.google.com/scholar?cites=2120866697955990770&as_sdt=2005&sciodt=0,5&hl=zh-CN">被引用次数：820</a>  2017年Nature Methods的评估中最好</p>
<p><strong>宏基因组最佳分箱工具Metabat2</strong></p>
<h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bowtie2-build --threads 30 /home/hanmz/project/RA/PRJNA356102/assembly/SRR5091489/SRR5091489.contigs.fa ./assembly/SRR5091489/SRR5091489-contigs_fa</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bowtie2 -p 40 --local --very-sensitive-local -x ./assembly/SRR5091489/SRR5091489-contigs_fa -1 /home/hanmz/project/RA/PRJNA356102/rawdata/SRR5091489_1_paired.fastq.gz -2 /home/hanmz/project/RA/PRJNA356102/rawdata/SRR5091489_2_paired.fastq.gz -S ./assembly/SRR5091489/SRR5091489_contigs.sam</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">samtools sort --threads 46 ./assembly/SRR5091489/SRR5091489_contigs.sam -o ./assembly/SRR5091489/SRR5091489_contigs.sort.bam</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jgi_summarize_bam_contig_depths --outputDepth ./assembly/SRR5091489/SRR5091489_depth.txt ./assembly/SRR5091489/SRR5091489_contigs.sort.bam</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">metabat2 -i /home/hanmz/project/RA/PRJNA356102/assembly/SRR5091489/SRR5091489.contigs.fa -a ./assembly/SRR5091489/SRR5091489_depth.txt -o ./assembly/SRR5091489/bin/SRR5091489_bin -t 46 </span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131935688.png" alt="image-20220331154620680"></p>
<p>得到以上文件</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131935237.png" alt="image-20220331154842083"></p>
<p>_depth.txt文件为<strong>统计contig深度</strong>得到的文件</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131935588.png" alt="image-20220331154959721"></p>
<p>bin目录下为.fa文件，&#x3D;&#x3D;为分箱结果&#x3D;&#x3D;</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131935592.png" alt="image-20220331154724677"></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131935925.png" alt="Bin采用的方法"></p>
<h1 id="Binning评估-CheckM"><a href="#Binning评估-CheckM" class="headerlink" title="Binning评估-CheckM"></a>Binning评估-CheckM</h1><hr>
<p>该软件的评估结果会给出&#x3D;&#x3D;completeness&#x3D;&#x3D;和&#x3D;&#x3D;contamination&#x3D;&#x3D;两个指标。同时也可以结合常用来检验样品污染的GC-Depth分布图来看是否存在污染，是否是chimeric genome bins。</p>
<blockquote>
<p>相关链接</p>
<p>checkM的GitHub<a target="_blank" rel="noopener" href="https://github.com/Ecogenomics/CheckM">https://github.com/Ecogenomics/CheckM</a></p>
<p>checkM的database<a target="_blank" rel="noopener" href="https://data.ace.uq.edu.au/public/CheckM_databases/">https://data.ace.uq.edu.au/public/CheckM_databases/</a></p>
<p>checkM说明文档<a target="_blank" rel="noopener" href="https://github.com/Ecogenomics/CheckM/wiki">https://github.com/Ecogenomics/CheckM/wiki</a></p>
<p>安装指导：</p>
<p><a target="_blank" rel="noopener" href="https://shenmengyuan.github.io/2016/12/22/checkm/%E7%9B%B8%E5%BD%93%E8%AF%A6%E7%BB%86:heart_eyes::star::raising_hand">https://shenmengyuan.github.io/2016/12/22/checkm/相当详细:heart_eyes::star::raising_hand</a>:</p>
</blockquote>
<h2 id="CheckM官方文档有道翻译"><a href="#CheckM官方文档有道翻译" class="headerlink" title="CheckM官方文档有道翻译"></a><strong>CheckM官方文档有道翻译</strong></h2><p>CheckM提供了一套工具，用于&#x3D;&#x3D;评估&#x3D;&#x3D;从分离物、单细胞或宏基因组中恢复的基因组的&#x3D;&#x3D;质量&#x3D;&#x3D;。<br>它通过使用在系统进化谱系中普遍存在的&#x3D;&#x3D;单拷贝的基因组合&#x3D;&#x3D;，提供了对基因组&#x3D;&#x3D;完整性和污染的可靠估计&#x3D;&#x3D;。<br>基因组质量的评估也可以使用描绘关键基因组特征(例如，GC，编码密度)的图来检查，这些图突出了典型基因组预期分布之外的序列。<br>CheckM还提供了一些工具，用于根据标记集的兼容性、基因组特征的相似性和参考基因组树的邻近性来识别可能需要合并的基因组箱。</p>
<p>如果你计划处理大量的基因组，你可能希望把它们分成小批量。<br>在64GB的机器上，用40个线程同时运行1000个基因组，运行得很好。<br>超过机器的可用内存将导致checkkm使用交换空间(与任何程序一样)，这将大大增加处理基因组的时间。</p>
<h3 id="Bioinformatic-tool-dependencies"><a href="#Bioinformatic-tool-dependencies" class="headerlink" title="Bioinformatic tool dependencies"></a>Bioinformatic tool dependencies</h3><p>CheckM requires the following programs to be <a target="_blank" rel="noopener" href="http://unix.stackexchange.com/questions/26047/how-to-correctly-add-a-path-to-path">added to your system path</a>:</p>
<p><a target="_blank" rel="noopener" href="http://hmmer.org/">HMMER</a> (&gt;&#x3D;3.1b1)</p>
<blockquote>
<p>安装之后还有几步需要操作，可以看下载的帮助文档</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/hyattpd/Prodigal">prodigal</a> (2.60 or &gt;&#x3D;2.6.1)</p>
<p><a target="_blank" rel="noopener" href="http://matsen.fhcrc.org/pplacer/">pplacer</a> (&gt;&#x3D;1.1)guppy是pplacer的一部分也必须添加到环境变量中</p>
<p>推荐使用pip安装CheckM：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip3是在Python3中的pip</span><br><span class="line">pip3 install numpy</span><br><span class="line">pip3 install matplotlib</span><br><span class="line">pip3 install pysam</span><br><span class="line">pip3 install checkm-genome</span><br></pre></td></tr></table></figure>

<h3 id="Required-reference-data参考数据库的下载"><a href="#Required-reference-data参考数据库的下载" class="headerlink" title="Required reference data参考数据库的下载"></a>Required reference data参考数据库的下载</h3><p>CheckM relies on a number of precalculated data files which can be downloaded from <a target="_blank" rel="noopener" href="https://data.ace.uq.edu.au/public/CheckM_databases/">https://data.ace.uq.edu.au/public/CheckM_databases/</a>. Decompress the file to an appropriate folder and run the following to inform CheckM of where the files have been placed:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; checkm data setRoot &lt;checkm_data_dir&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#测试数据</span><br><span class="line">~/biosoft/metabat_data</span><br><span class="line">$ checkm test ~/checkm_test_results</span><br><span class="line">####结果</span><br><span class="line">[2022-03-31 19:57:20] INFO: [Passed]</span><br><span class="line">[2022-03-31 19:57:20] INFO: &#123; Current stage: 0:00:00.005 || Total: 0:05:17.882 &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131935369.png" alt="checkm_test_results"></p>
<h3 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h3><blockquote>
<p>参考链接<a target="_blank" rel="noopener" href="http://www.mselab.cn/detail/81/%E5%BF%AB%E7%9C%8B%E5%AE%83:+1::+1::+1::+1::+1">http://www.mselab.cn/detail/81/快看它:+1::+1::+1::+1::+1</a>:</p>
</blockquote>
<p>基因组组装或者宏基因组分箱 (binning) 获得的草图数据，首先需要评估其<strong>质量</strong>，包括<strong>基因组完整度</strong>、<strong>污染度</strong>、<strong>序列分布</strong>等信息。最用的软件有 <a target="_blank" rel="noopener" href="https://ecogenomics.github.io/CheckM/">CheckM</a>。</p>
<p>CheckM 提供了一系列工具用于评估从分离培养、单细胞、宏基因组获得的基因组<strong>质量</strong>，可以根据基因组在<strong>参考基因组发育树中的位置</strong>来推断其精确的<strong>单拷贝标记基因集</strong> (lineage-specific marker set)，同时也提供数据库可用的基于分类学的基因集 (taxonomic-specific marker set)。</p>
<p>CheckM 利用基因的<strong>单拷贝性</strong>来有效的估计基因组完整度和污染可能性，同时能绘制基因组关键特征 (例如：GC含量) 的图像来评估基因组的质量。</p>
<p>还可以进一步从每一个分箱中找出<strong>16S rRNA基因</strong>，以便于后续对所拼装达到的菌种的分类信息进行鉴定。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(py37) [chenl@cpu4 ~]$ whereis checkm</span><br><span class="line">checkm: /home/chenl/miniconda2/envs/py37/bin/checkm</span><br></pre></td></tr></table></figure>

<h3 id="实战-1"><a href="#实战-1" class="headerlink" title="实战"></a>实战</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">checkm lineage_wf -t 45 -x fa --nt --tab_table -f /home/chenl/RA/PRJNA356102/assembly/SRR5091489/result-bin/SRR5091489_bins_qa.txt /home/chenl/RA/PRJNA356102/assembly/SRR5091489/bin /home/chenl/RA/PRJNA356102/assembly/SRR5091489/result-bin</span><br></pre></td></tr></table></figure>



<p>求求给个三连再走</p>
<p>:loudspeaker::bow::pray::+1::star::heartbeat:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">checkm lineage_wf -t 46 -x fa --nt --tab_table -f bins_qa.txt metabat_bins bin_qa_result </span><br></pre></td></tr></table></figure>

<p>完整度是实际上有的Mark基因除以应该有的基因</p>
<p>污染度是bin里包含的基因有多少不属于这个bin的（幅度大）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">checkm unbinned</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/16/016Common%20Data%20File%20Formats%20in%20Bioinformatics/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/16/016Common%20Data%20File%20Formats%20in%20Bioinformatics/" class="post-title-link" itemprop="url">Common Data File Formats in Bioinformatics</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-16 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-16T09:25:00+08:00">2022-05-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:32" itemprop="dateModified" datetime="2023-03-23T21:51:32+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Common-Data-File-Formats-in-Bioinformatics"><a href="#Common-Data-File-Formats-in-Bioinformatics" class="headerlink" title="Common Data File Formats in Bioinformatics"></a>Common Data File Formats in Bioinformatics</h1><ul>
<li><p>利用<strong>Sanger、illumina、第三代和第四代测序技术</strong>，我们测序得到的是带有质量值的碱基序列&#x3D;&#x3D;fastq&#x3D;&#x3D;格式，参考基因组是&#x3D;&#x3D;fasta&#x3D;&#x3D;格式。</p>
</li>
<li><p>用比对工具把fastq格式的序列回帖到对应的fasta格式的参考基因组序列，就可以产⽣&#x3D;&#x3D;sam&#x3D;&#x3D;格式的⽐对⽂件。</p>
</li>
<li><p>把sam格式的⽂本⽂件压缩成&#x3D;&#x3D;⼆进制bam&#x3D;&#x3D;⽂件可以节省空间。</p>
</li>
<li><p>如果是记录某些位点或者区域碱基的变化，就是&#x3D;&#x3D;VCF&#x3D;&#x3D;⽂件格式。</p>
</li>
<li><p>如果对参考基因组上面的各个区段标记它们的性质，比如哪些区域是外显子，内含子， UTR等等，这就是&#x3D;&#x3D;gtf&#x2F;gff&#x3D;&#x3D;格式。</p>
</li>
<li><p>如果只是为了单纯描述某个基因组区域，就是&#x3D;&#x3D;bed&#x3D;&#x3D;格式⽂件，记录染色体号以及起始终止坐标，正负链即可。</p>
</li>
</ul>
<h2 id="fastq文件"><a href="#fastq文件" class="headerlink" title="fastq文件"></a>fastq文件</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote>
<p>fastq&#x3D;fasta+quality(Fasta格式加上质量数据)</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://support.illumina.com/bulletins/2016/04/chinese-fastq-files-explained.html">https://support.illumina.com/bulletins/2016/04/chinese-fastq-files-explained.html</a></p>
<p><a target="_blank" rel="noopener" href="https://help.basespace.illumina.com/articles/descriptive/fastq-files/">https://help.basespace.illumina.com/articles/descriptive/fastq-files/</a></p>
<blockquote>
<p>Illumina测序技术使用 <a target="_blank" rel="noopener" href="https://v.youku.com/v_show/id_XMzMxMTk0NzQ5Ng==.html?spm=a2h3j.8428770.3416059.1">簇生成和边合成边测序（SBS）化学技术</a>对流动槽（flow cell）上数百万或数十亿簇（cluster）进行测序，具体簇的数目取决于测序平台。 在边合成边测序化学过程中，仪器上的实时分析（RTA）软件对每个簇的每个循环进行碱基检出和存储。 RTA以单个读取碱基（base call，或称BCL）文件的形式存储碱基检出数据。 测序完成后，必须将BCL文件中的测定的碱基转换为序列数据。 此过程称为BCL到FASTQ的转换。</p>
</blockquote>
<p>FASTQ是基于文本的，保存生物序列（通常是核酸序列）和其测序质量信息的<strong>标准</strong>格式。其序列以及质量信息都是使用一个ASCII字符标示，最初由Sanger开发，目的是<strong>将FASTA序列与质量数据放到一起</strong>，目前已经成为高通量测序结果的事实标准。</p>
<p>对于单端测序的运行，将为每个流动槽上每条通道的每个样品创建一个Read 1（R1）FASTQ文件。 对于双端测序的运行，将为每个流动槽上每条通道的每个样品各创建一个R1和一个Read 2（R2）FASTQ文件。 FASTQ文件是使用扩展名*.fastq.gz压缩和创建的。</p>
<h3 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h3><p><img src="https://gitee.com/cling5899/Typora-img/raw/master/img/20220406150036.png" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131914439.png" alt="preload"></p>
<ol>
<li><p>第一行以@开头，序列标识符，其中包含有关测序运行和簇的信息。 该行的具体内容会因使用的BCL到FASTQ转换软件而不同。（与FASTA格式的描述行类似）</p>
</li>
<li><p>序列（碱基信号； A，C，T，G和N）。</p>
</li>
<li><p>分隔符，只是一个加号（+），之后可以再次加上序列的标识及描述信息（可选）。</p>
</li>
<li><p>读取碱基的质量值。，与第二行的序列相对应，长度必须与第二行相同。这些是Phred +33编码的，使用ASCII字符表示数字质量值。</p>
</li>
</ol>
<p>其中!为最低质量、~则为最高质量。以下字符从左到右代表从低到高的质量得分的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131914367.png" alt="image-20220406150612091"></p>
<p>质量值的计算公式如下：$Q&#x3D;-10 \times log_{10}P$</p>
<p>这个公式中Q表示的是潜在错误的概率，Q值越大，表明测错的可能性越小。下面是Q值对应的错误率表：</p>
<table>
<thead>
<tr>
<th>Phred Quality Score</th>
<th>Probability of incorrect base call</th>
<th>Base call accuracy</th>
</tr>
</thead>
<tbody><tr>
<td>10</td>
<td>1 in 10</td>
<td>90%</td>
</tr>
<tr>
<td>20</td>
<td>1 in 100</td>
<td>99%</td>
</tr>
<tr>
<td>30</td>
<td>1 in 1000</td>
<td>99.9%</td>
</tr>
<tr>
<td>40</td>
<td>1 in 10000</td>
<td>99.99%</td>
</tr>
<tr>
<td>50</td>
<td>1 in 100000</td>
<td>99.999%</td>
</tr>
<tr>
<td>60</td>
<td>1 in 1000000</td>
<td>99.9999%</td>
</tr>
</tbody></table>
<p>举个犊子，假设&#x3D;&#x3D;质量信息是5&#x3D;&#x3D;，这个5看成字符，不要看成数字，那么他对应的十进制数就是53，如果使用的是Sanger测序，那么质量评分采用的就是Phred+33的形式，那么Q &#x3D; 53-33&#x3D;20&#x3D;-10lg(errorP)，所以errorP &#x3D; 0.01。也就计算出错误率啦，就便于我们进行质控。每一个碱基都有一个质量评分，所以第2行和第4行的位数是相同的。&#x3D;&#x3D;Q值&#x3D;20&gt;&gt;errorP&#x3D;0.01&gt;&gt;碱基准确度就是99%。&#x3D;&#x3D;</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131914829.png" alt="image-20220406153327147"></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131914644.png" alt="preload"></p>
<blockquote>
<p>质量评分指的是一个碱基的错误概率的对数值。其最初在Phred拼接软件中定义与使用，对于每个碱基的质量编码标示，不同的软件采用不同的方案，目前有5种方案：</p>
</blockquote>
<ul>
<li>Sanger，Phred quality score，值的范围从0到92，对应的ASCII码从33到126，但是对于测序数据（raw read data）质量得分通常小于60，序列拼接或者mapping可能用到更大的分数。</li>
<li>Solexa&#x2F;Illumina 1.0, Solexa&#x2F;Illumina quality score，值的范围从-5到63，对应的ASCII码从59到126，对于测序数据，得分一般在-5到40之间；</li>
<li>Illumina 1.3+，Phred quality score，值的范围从0到62对应的ASCII码从64到126，低于测序数据，得分在0到40之间；</li>
<li>Illumina 1.5+，Phred quality score，但是0到2作为另外的标示；</li>
<li>Illumina 1.8+ ，Phred quality score。</li>
</ul>
<h2 id="fasta文件"><a href="#fasta文件" class="headerlink" title="fasta文件"></a>fasta文件</h2><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><p>FASTA格式是一种用于表示&#x3D;&#x3D;核苷酸序列&#x3D;&#x3D;或&#x3D;&#x3D;多肽序列&#x3D;&#x3D;的文本格式。其中碱基对或氨基酸用&#x3D;&#x3D;单个字母&#x3D;&#x3D;来表示，且允许在序列前添加序列名及注释。该格式已成为生物信息学领域的一项标准。</p>
<p>FASTA简明的格式降低了序列操纵和分析的难度，令序列可被文本处理工具和诸如<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Python">Python</a>、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Ruby">Ruby</a>和<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/Perl">Perl</a>等<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80">脚本语言</a>处理。</p>
<h3 id="格式-1"><a href="#格式-1" class="headerlink" title="格式"></a>格式</h3><p>FASTA格式中的一条完整序列，包含开头的单行描述行和多行序列数据。描述行行首前置半角大于号（“&gt;”）以和数据行区分。“&gt;”后紧接的内容为该序列的标识符（&#x3D;&#x3D;唯一的&#x3D;&#x3D;），该行剩余部分则为序列的描述（标识符与描述均非必须）。“&gt;”和标识符之间不应有空格，且建议将<strong>单行内容限制在80字符以内</strong>。序列的结束以下一条序列的“&gt;”出现为标识。如下为FASTA评论区格式一条序列的示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;gi|31563518|ref|NP_852610.1 关，瓦斯4 microtubule-associated proteins 1A/1B light chain 3A isoform b [Homo sapiens]</span><br><span class="line">MKMRFFSSPCGKAAVDPADRCKEVQQIRDQHPSKIPVIIERYKGEKQLPVLDKTKFLVPDHVNMSELVKI</span><br><span class="line">IRRRLQLNPTQAFFLLVNQHSMVSVSTPIADIYEQEKDEDGFLYMVYASQETFGFIRENE</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131914697.png" alt="img"></p>
<p><strong>核苷酸序列：</strong></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131914702.png" alt="preload"></p>
<p><strong>氨基酸序列：</strong></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131914320.png" alt="img"></p>
<h2 id="SAM文件-x2F-BAM文件"><a href="#SAM文件-x2F-BAM文件" class="headerlink" title="SAM文件&#x2F;BAM文件"></a>SAM文件&#x2F;BAM文件</h2><h3 id="概念-2"><a href="#概念-2" class="headerlink" title="概念"></a>概念</h3><p><a target="_blank" rel="noopener" href="https://www.samformat.info/sam-format-flag">官网介绍</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/dataanaly/p/13177364.html">SAM详细介绍</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/genome_denovo/article/details/78712972">CSDN上的SAM介绍</a></p>
<p>当我们测序得到的fastq数据map到基因组（比如用bowtie2来mapping）之后，会得到一个以sam或bam为扩展名的文件。这里，SAM的全称是<strong>sequence alignment&#x2F;map format</strong>。而BAM就是SAM的二进制文件，也就是压缩格式的sam文件。</p>
<p>SAM格式文件包括<strong>头部注释部分</strong>和<strong>比对结果部分</strong>，头部分为’’可选部分’’。头部分位于比对部分之前，以“@”开头。比对部分有11列是固定的，其他多列可选。</p>
<p>头部信息介绍</p>
<p>每个标题行以字符”@”开头，后面是两个字母的记录类型代码。在标题中，每一行都是由制表符分隔的。除了@CO行，每个数据字段都遵循格式”TAG:VALUE”，其中TAG是两个字母组成的字符串，定义了内容和值的格式。每个标题行应该匹配:&#x2F;^ @(HD|SQ|RG|PG)(t[A-Z&#x2F;a-z][A-Z&#x2F;a-z&#x2F;0-9]:[-~]+)+$ &#x2F;或&#x2F;^@CO\t.*&#x2F;。小写字母是保留给用户自定义内容使用的，不会在任何版本定义中出现。以下给出了定义的记录类型和标记。<strong>当以下TAG标签出现”*“时，表示该TAG是必须的，如@SQ必须有SN和LN字段</strong>。</p>
<p>比对信息介绍<br>比对信息部分(alignment section)，每一行表示一个片段（segment）的比对信息，包括11个必须的字段（mandatory fields）和一个可选的字段，字段之间用tab分割。必须的字段有11个，顺序固定，不可用时，根据字段定义，可以为’0’或者’*’，这是11个字段包括：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">1. QNAME 比对片段的（template）的编号；read name，read的名字通常包括测序平台等信息</span><br><span class="line"># eg.E00528:375:HN2JTCCXY:8:1123:5457:24479</span><br><span class="line">2. FLAG  位标识，template mapping情况的数字表示，每一个数字代表一种比对情况，这里的值是符合情况的数字相加总和</span><br><span class="line"># eg.16</span><br><span class="line">3. RNAME 参考序列的编号，如果头部注释中对SQ-SN进行了定义，这里必须和其保持一致，另外对于没有mapping上的序列，这里是&#x27;*&#x27;；</span><br><span class="line"># eg.chr1</span><br><span class="line">4. POS  比对上的位置，注意是从1开始计数，没有比对上，此处为0;</span><br><span class="line"># eg.36576599</span><br><span class="line">5. MAPQ mapping的质量，比对的质量分数，越高说明该read比对到参考基因组上的位置越唯一;</span><br><span class="line"># eg.42</span><br><span class="line">6. CIGAR 简要比对信息表达式（Compact Idiosyncratic Gapped Alignment Report），其以参考序列为基础，使用数字加字母表示比对结果，match/mismatch、insertion、deletion 对应字母 M、I、D。比如3S6M1P1I4M，前三个碱基被剪切去除了，然后6个比对上了，然后打开了一个缺口，有一个碱基插入，最后是4个比对上了，是按照顺序的；</span><br><span class="line"># eg.36M 表示36个碱基在比对时完全匹配</span><br><span class="line"></span><br><span class="line">###注：第七列到第九列是mate的信息，若是单末端测序这几列均无意义###</span><br><span class="line"></span><br><span class="line">7. RNEXT 配对片段（即mate）比对上的参考序列的编号，没有另外的片段，这里是&#x27;*&#x27;，同一个片段，用&#x27;=&#x27;；</span><br><span class="line"># eg.*</span><br><span class="line">8. PNEXT 配对片段（即mate）比对到参考序列上的第一个碱基位置，若无mate,则为0；</span><br><span class="line"># eg.0</span><br><span class="line">9. TLEN  Template（文库插入序列）的长度，最左边的为正，最右边的为负，中间的不用定义正负，不分区段（single-segment)的比对上，或者不可用时，此处为0(ISIZE，Inferred fragment size.详见Illumina中paired end sequencing 和 mate pair sequencing，是负数，推测应该是两条read之间的间隔(待查证)，若无mate则为0);</span><br><span class="line"># eg.0</span><br><span class="line">10. SEQ  序列片段的序列信息，如果不存储此类信息，此处为&#x27;*&#x27;，注意CIGAR中M/I/S/=/X对应数字的和要等于序列长度；</span><br><span class="line"># eg.CGTTTCTGTGGGTGATGGGCCTGAGGGGCGTTCTCN</span><br><span class="line">11. QUAL 序列的质量信息, read质量的ASCII编码。格式同FASTQ一样。</span><br><span class="line"># eg.F-?DD&lt;,EEFFEEC?F5FA7FAF8FAF;F@E:DF&gt;FEEAFFFFFCFFC4EFDFDDFEFE=EFFF</span><br><span class="line">12.第十二列及之后：Optional fields，以tab建分割。</span><br><span class="line"># eg.AS:i:-1 XN:i:0 XM:i:1 XO:i:0 XG:i:0 NM:i:1 MD:Z:35T0 YT:Z:UU</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\1. **QNAME**：reads名称。</span><br><span class="line">\2. **FLAG**：reads比对情况。不同的情况对应不同的值，这里的数字是所有情况的和。</span><br><span class="line">\3. **RNAME**：比对至参考序列的名称。</span><br><span class="line">\4. **POS**：比对到的位置。</span><br><span class="line">\5. **MAPQ**：比对质量。</span><br><span class="line">\6. **CIGAR**：比对情况信息。</span><br><span class="line">\7. **RNEXT**：与之配对的另一条reads所在的参考序列名称。&quot;=&quot;表示位于同一个参考序列上，&quot;*&quot;表示没有另一条reads。</span><br><span class="line">\8. **PNEXT**：与之配对的另一条reads所在的位置。</span><br><span class="line">\9. **TLEN**：插入片段长度。</span><br><span class="line">\10. **SEQ**：reads序列。</span><br><span class="line">\11. **QUAL**：reads序列质量</span><br><span class="line">NH:i:n 表示reads比对到参考序列位置的个数。</span><br><span class="line">AS:i:n 表示比对得分。</span><br></pre></td></tr></table></figure>

<h3 id="格式-2"><a href="#格式-2" class="headerlink" title="格式"></a>格式</h3><p>例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@HD VN:1.4	SO:coordinate</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@HD     VN:1.5  SO:unsorted     GO:query  ##输出文件第一行</span><br><span class="line">@SQ     SN:k127_19953   LN:526</span><br><span class="line">@SQ     SN:k127_3992    LN:562     ###@SQ 参考序列字典，@SQ行的顺序定义了比对文件排序顺序。</span><br><span class="line">@SQ     SN:k127_15965   LN:635     ###SN* 参考序列名字(染色体)。用于RNAME和PNEXT比对的记录</span><br><span class="line">@SQ     SN:k127_32914   LN:521     ###LN* 参考序列长度，范围:[$1,2^&#123;31&#125;-1$]</span><br><span class="line">@SQ     SN:k127_35905   LN:622     ###</span><br><span class="line">@SQ     SN:k127_7984    LN:664     ###</span><br><span class="line">@SQ     SN:k127_17959   LN:506     ###</span><br><span class="line">@SQ     SN:k127_20950   LN:547     ###</span><br><span class="line">@SQ     SN:k127_11976   LN:697     ###</span><br><span class="line">@SQ     SN:k127_26932   LN:770     ###</span><br><span class="line">@SQ     SN:k127_2995    LN:515     ###</span><br><span class="line">@SQ     SN:k127_23941   LN:826     ###</span><br><span class="line">@SQ     SN:k127_41887   LN:788     ###</span><br><span class="line">@SQ     SN:k127_14968   LN:970     ###</span><br><span class="line">@SQ     SN:k127_8983    LN:511     ###</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 例如</span><br><span class="line">@SQ	SN:chr1	LN:249250621	M5:1b22b98cdeb4a9304cb5d48026a85128	UR:file:/opt/biosoft/ref/sv/hg19_ref_genome.primary-assembly.fa</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">E00514:173:H3C3JCCXY:4:1124:12398:67234    337 Chr00   32904   0   150M    Chr09   33498107    0   TCAATTTCACTTGAAGCTTACTTGTAGTTTCAGGCTTGGTCAAGCGCGATACAAACCATGTAGTAGGAGTCCTCCAAGTCGCCAAGCTAGGGGATCTGCTGAAAGAGGTGACAGACAAGGTAAGCAATCAGAGCTCTAAGCAATCAGTCC  iieiiiii`eiiiiiiiiiiiiiiieiiiiiiiieiiiiiiiiiiiiiiiiiiiiieiiiiiiiiiiiiieiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiieiiiiiiiii`iiieeieieeieee``  AS:i:-6 XN:i:0  XM:i:1  XO:i:0  XG:i:0  NM:i:1  MD:Z:136C13 YT:Z:UU NH:i:8  CC:Z:Chr10  CP:i:18604313   HI:i:0  RG:Z:J36CK1</span><br><span class="line">E00514:173:H3C3JCCXY:4:1124:12398:67234    369 Chr00   32904   0   150M    Chr16   2469225 0   TCAATTTCACTTGAAGCTTACTTGTAGTTTCAGGCTTGGTCAAGCGCGATACAAACCATGTAGTAGGAGTCCTCCAAGTCGCCAAGCTAGGGGATCTGCTGAAAGAGGTGACAGACAAGGTAAGCAATCAGAGCTCTAAGCAATCAGTCC  iieiiiii`eiiiiiiiiiiiiiiieiiiiiiiieiiiiiiiiiiiiiiiiiiiiieiiiiiiiiiiiiieiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiieiiiiiiiii`iiieeieieeieee``  AS:i:-6 XN:i:0  XM:i:1  XO:i:0  XG:i:0  NM:i:1  MD:Z:136C13 YT:Z:UU NH:i:8  CC:Z:Chr10  CP:i:18604313   HI:i:2  RG:Z:J36CK1</span><br><span class="line">E00514:173:H3C3JCCXY:4:1124:12398:67234    369 Chr00   32904   0   150M    Chr16   29515410    0   TCAATTTCACTTGAAGCTTACTTGTAGTTTCAGGCTTGGTCAAGCGCGATACAAACCATGTAGTAGGAGTCCTCCAAGTCGCCAAGCTAGGGGATCTGCTGAAAGAGGTGACAGACAAGGTAAGCAATCAGAGCTCTAAGCAATCAGTCC  iieiiiii`eiiiiiiiiiiiiiiieiiiiiiiieiiiiiiiiiiiiiiiiiiiiieiiiiiiiiiiiiieiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiieiiiiiiiii`iiieeieieeieee``  AS:i:-6 XN:i:0  XM:i:1  XO:i:0  XG:i:0  NM:i:1  MD:Z:136C13 YT:Z:UU NH:i:8  CC:Z:Chr10  CP:i:18604313   HI:i:4  RG:Z:J36CK1</span><br></pre></td></tr></table></figure>

<h2 id="GTF和GFF文件"><a href="#GTF和GFF文件" class="headerlink" title="GTF和GFF文件"></a>GTF和GFF文件</h2><h3 id="概念-3"><a href="#概念-3" class="headerlink" title="概念"></a>概念</h3><p>GTF全称是Gene transfer format，用于储存基因结构信息，总共有9列。关于gtf文件，我在文章：<strong>生信中各种ID转换</strong>中就已经有所应用。我之前在<strong>TCGA</strong><a target="_blank" rel="noopener" href="https://cloud.tencent.com/solution/database?from=10680"><strong>数据库</strong></a><strong>差异分析</strong>的文章中，也是通过gtf文件进行ID转换的。</p>
<h3 id="格式-3"><a href="#格式-3" class="headerlink" title="格式"></a>格式</h3><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131915893.png" alt="preload"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/15/015pigz_and_mutliprogress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/15/015pigz_and_mutliprogress/" class="post-title-link" itemprop="url">如何加快压缩和解压缩的速度</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-15 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-15T09:25:00+08:00">2022-05-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:31" itemprop="dateModified" datetime="2023-03-23T21:51:31+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Lunix/" itemprop="url" rel="index"><span itemprop="name">Lunix</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>参考文章为生信技能树</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Aa411e791?spm_id_from=444.41.list.card_archive.click">https://www.bilibili.com/video/BV1Aa411e791?spm_id_from=444.41.list.card_archive.click</a></p>
</blockquote>
<p>如何加快压缩和解压缩的速度</p>
<ol>
<li><p>gzip&#x2F;gunzip</p>
<p>压缩：gzip readme.txt</p>
<p>解压：gunzip readme.txt.gz</p>
</li>
<li><p>zip&#x2F;unzip</p>
<p>压缩：zip readme.txt.zip readme.txt</p>
<p>解压：unzip readme.txt.zip</p>
</li>
<li><p>bzip2</p>
<p>压缩：bzip2 readme.txt</p>
<p>解压：bizp2 readme.txt.bz2</p>
</li>
<li><p>tar（适用于多个文件）</p>
<p>压缩：tar -zcvf output.tar.gz file1 file2</p>
<p>解压：tar -zxvf input.tar.gz</p>
</li>
</ol>
<p>这些都是&#x3D;&#x3D;单线程&#x3D;&#x3D;的</p>
<h2 id="pigz"><a href="#pigz" class="headerlink" title="pigz"></a>pigz</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lscpu 看当前cpu的一些参数</span><br></pre></td></tr></table></figure>

<p>可以多线程进行压缩和解压缩</p>
<p>conda install pigz</p>
<p>参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-d --decompress 解压缩</span><br><span class="line">-p --processes n 使用几个线程来解压</span><br><span class="line">-k --keep 保留原文件</span><br><span class="line">-c --stdout 输出到标准输出流</span><br></pre></td></tr></table></figure>

<h3 id="压缩成-gz格式"><a href="#压缩成-gz格式" class="headerlink" title="压缩成.gz格式"></a>压缩成.gz格式</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pigz -k -p 8 file1</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131923058.png" alt="image-20220429093050482"></p>
<p>很快啊</p>
<h3 id="压缩成-tar-gz"><a href="#压缩成-tar-gz" class="headerlink" title="压缩成.tar.gz"></a>压缩成.tar.gz</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -cvf - file1 file2 file3 |pigz -p 8 &gt; output.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131923519.png" alt="image-20220429094621982"></p>
<h3 id="解压-gz格式的文件"><a href="#解压-gz格式的文件" class="headerlink" title="解压.gz格式的文件"></a>解压.gz格式的文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pigz -d -k -p 48 SRR13436208_mapped_and_unmapped.fastq.gz</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131923567.png" alt="image-20220429094954973"></p>
<h3 id="解压缩-tar-gz格式的文件"><a href="#解压缩-tar-gz格式的文件" class="headerlink" title="解压缩.tar.gz格式的文件"></a>解压缩.tar.gz格式的文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pigz -d -c -p 48 1.tar.gz | tar -xf -</span><br></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131923739.png" alt="image-20220429095638669"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/14/014Biostatistics-chapter8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/14/014Biostatistics-chapter8/" class="post-title-link" itemprop="url">Biostatistics课程学习笔记第八章非参数检验和线性代数基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-14 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-14T09:25:00+08:00">2022-05-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:30" itemprop="dateModified" datetime="2023-03-23T21:51:30+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="第八讲-非参数检验和线性代数基础"><a href="#第八讲-非参数检验和线性代数基础" class="headerlink" title="第八讲 非参数检验和线性代数基础"></a>第八讲 非参数检验和线性代数基础</h1><h2 id="第一部分-非参数检验"><a href="#第一部分-非参数检验" class="headerlink" title="第一部分 非参数检验"></a>第一部分 非参数检验</h2><p>对于非正态分布资料，实施统计处理的一个重要途径是先作变量的转换，使转换后的资料近似正态分布，然后按正态分布的方法作统计处理。</p>
<hr>
<p>相关系数的区间估计</p>
<p>在ρ不为0时，r的抽样分布就不服从t分布或u分布(实质是<strong>偏态分布</strong>)，所以不能套用第四章中置信区间公式。</p>
<p>这时可以利用z转换，把r转换称z，而z是近似服从正态分布的。<br>$$<br>z&#x3D;0.5ln\frac{1+r}{1-r}\<br>\sigma_z&#x3D;\sqrt{\frac{1}{n-3}}<br>$$</p>
<p>$$<br>L_z&#x3D;z\pm\mu_\alpha\sigma_z\<br>L_r&#x3D;\frac{e^2L_z-1}{e^2L_z+1}<br>$$</p>
<p>•对于一个不服从正态分布的数据，我们可以通过某种计算<strong>转换成一个服从正态分布的量</strong>，再根据正态分布的抽样理论计算，最后反转换成原来的数据，这种思想非常重要。</p>
<hr>
<p>•在总体分布已知的前提下，首先对总体参数提出一个假设，然后通过样本数据推断这个假设是否可以被接受。这样称为<strong>参数检验</strong>(parametric test)。</p>
<p>•<strong>非参数检验</strong>(nonparametric test)就是不要求总体服从特定分布，也不需要计算总体参数的统计推断。本章仅介绍通过样本数据排序编秩后，基于秩次比较的非参数检验。</p>
<hr>
<h3 id="对成组数据"><a href="#对成组数据" class="headerlink" title="对成组数据"></a>对成组数据</h3><p>•Wilcoxon秩和检验(rank sum test)步骤</p>
<p>•1. 把两组数据合成一组，从小到大排列好，每个数据对应的序号称为秩(rank)(注意相等数值均取平均秩次)。</p>
<p>•2. 再把两组数据分开，分别计算两个样本的秩和。</p>
<p>•3. 以含量较小的样本的秩和作为检验统计量。</p>
<p>•4. 查T临界值表或使用z值的u检验。</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131918908.png" alt="image-20220413085135494"></p>
<p>z值的u检验</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131918094.png" alt="image-20220413085226837"></p>
<p>•在符合零假设的情况下，z值符合标准正态分布(n1&lt;&#x3D;n2)，如果z值落入标准正态分布的小概率区域，则认为零假设不成立。</p>
<h3 id="对配对数据"><a href="#对配对数据" class="headerlink" title="对配对数据"></a>对配对数据</h3><p>•Wilcoxon符号秩检验(signed-rank test)。</p>
<p>•1. 按差值d的绝对值大小编秩次(差值为0的数据舍去不计，差值绝对值相等的数据均取平均秩次)</p>
<p>•2. 根据差值d的符号给秩次<strong>加上符号</strong>。</p>
<p>•3. 求出正负秩次之和T+和T-，任选其一作为统计量T。</p>
<p>•4. 查T临界值表或使用z值的u检验。</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131918247.png" alt="image-20220413085615169"></p>
<h3 id="非参数检验和参数检验比较"><a href="#非参数检验和参数检验比较" class="headerlink" title="非参数检验和参数检验比较"></a>非参数检验和参数检验比较</h3><p>•对于不明显偏离正态分布的数据，两种方法都可以使用，但是<strong>首选是参数检验。</strong></p>
<p>•因为非参数检验把具体的数值转化成秩次，<strong>降低了信息的利用率。</strong></p>
<p>•非参数检验优点是<strong>适用范围广，尤其适用于：</strong></p>
<p>•1. 总体分布未知或明显偏离正态分布的数据。</p>
<p>•2. 有序或半定量的数据。</p>
<p>•3. 两端无确定数值的数据。</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131918864.png" alt="image-20220413090137065"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/13/013Biostatistics-chapter7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/13/013Biostatistics-chapter7/" class="post-title-link" itemprop="url">Biostatistics生物统计学第七讲Linear regression and correlation analysis</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-13 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-13T09:25:00+08:00">2022-05-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:29" itemprop="dateModified" datetime="2023-03-23T21:51:29+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Linear-regression-and-correlation-analysis"><a href="#Linear-regression-and-correlation-analysis" class="headerlink" title="Linear regression and correlation analysis"></a>Linear regression and correlation analysis</h1><blockquote>
<p>•第五章中，我们介绍了如何研究两个定性变量是否有关系的问题。</p>
<p>•实际工作中，我们经常需要研究两个或两个以上定量变量是否有关系，有怎么样的关系。</p>
<p>•对于生物学数据，因为存在随机性和变异性等，所以通常不能推导出确定的函数关系，但是可以使用统计学上的回归与相关分析研究其分布情况(如平均数、标准差和置信区间)。</p>
</blockquote>
<p>因果关系与平行关系</p>
<p>•经常地，我们发现一个变量随着另一个变量的变化而变化，但是这不一定说明两者存在<strong>因果关系</strong>。</p>
<p>•还有一种可能是这两者共同受到另外一个变量的影响，称为<strong>平行关系</strong>。</p>
<hr>
<p>散点图(scatter chart):直观的查看x、y的关系。</p>
<ol>
<li><p>两个变量间关系的性质和程度；</p>
</li>
<li><p>两个变量间关系的类型，是直线型或者曲线型。</p>
</li>
<li><p>是否有异常观测值的干扰</p>
</li>
</ol>
<hr>
<p>&#x3D;&#x3D;回归分析&#x3D;&#x3D;(regression analysis)：回归分析经常用于研究两个变量的因果关系，建立回归方程用于根据<strong>自变量</strong>&#x3D;&#x3D;预测&#x3D;&#x3D;和&#x3D;&#x3D;控制&#x3D;&#x3D;<strong>因变量</strong>。</p>
<p>表示<strong>原因</strong>的变量称为自变量(independent variable)，常用x表示，一般是试验中预先确定的，<strong>没有随机误差</strong>。</p>
<p>表示<strong>结果</strong>的变量称为因变量(dependent variable)，常用y表示，y随x的变化而变化，且<strong>具有随机误差</strong>。</p>
<table>
<thead>
<tr>
<th>回归分析的分类</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>根据自变量，因变量的数目</td>
<td>一个自变量与一个因变量：一元回归分析</td>
</tr>
<tr>
<td></td>
<td>多个自变量与一个因变量：多元回归分析</td>
</tr>
<tr>
<td>根据变量间关系的类型</td>
<td>直线回归(linear regression)</td>
</tr>
<tr>
<td></td>
<td>曲线回归(curve regression)</td>
</tr>
</tbody></table>
<hr>
<p>相关分析(correlation analysis)：相关分析通常用于研究两个变量的平行关系。变量x和y无自变量和因变量之分，且<strong>都具有随机误差</strong>。</p>
<table>
<thead>
<tr>
<th>相关分析的分类</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>对两个变量之间的直线关系进行相关分析</td>
<td>直线相关(linear correlation)分析或简单相关(simple correlation)分析</td>
</tr>
<tr>
<td>一个变量与多个变量的线性相关</td>
<td>复(multiple)相关分析</td>
</tr>
<tr>
<td>保持其余变量不变的情况下研究两个变量的线性相关</td>
<td>偏(partitial)相关分析</td>
</tr>
</tbody></table>
<hr>
<h2 id="直线回归"><a href="#直线回归" class="headerlink" title="直线回归"></a>直线回归</h2><p>直线回归的数学模型</p>
<p>虽然x固定时，y并没有确定的值，但是此时y的分布是固定的，或者说<strong>其平均数等指标是固定的</strong>。<br>$$<br>\mu_Y&#x3D;\alpha+\beta X<br>$$<br>$\alpha$为直线在y轴的截距(intercept)</p>
<p>$\beta$为直线的斜率(slope)<br>$$<br>Y&#x3D;\alpha+\beta X+\epsilon<br>$$<br>若使用样本资料估计参数<br>$$<br>y&#x3D;a+bx+e<br>$$</p>
<p>&#x3D;&#x3D;直线回归方程的参数估计&#x3D;&#x3D;<br>$$<br>b&#x3D;\frac{\sum (x-\overline x)-(y-\overline y)}<br>{\sum(x-\overline x)^2}<br>&#x3D;\frac{SP}{SS_x}<br>$$</p>
<p>b的分子简称为两个离均差的乘积和，记作SP或$SS_{xy}$</p>
<p>b的分母称为离均差平方和，记作$SS_x$</p>
<p>$\alpha&#x3D;\overline y-b\overline x$</p>
<hr>
<p>回归方程的三个基本性质</p>
<p>(1)$Q&#x3D;\sum(y-\hat y)^2$最小</p>
<p>(2)$\sum(y-\hat y)&#x3D;\sum(y-a-bx)&#x3D;0$</p>
<p>(3)$\hat y&#x3D;\overline y-b\overline x+bx&#x3D;\overline y+b(x-\overline x)$即直线通过中心点$(\overline x,\overline y)$</p>
<p>注意：直线回归方程的适用范围不能超过计算时用到的x的范围；不是所有的散点都落在回归直线上，但是很接近回归直线。</p>
<hr>
<h3 id="直线回归的假设检验"><a href="#直线回归的假设检验" class="headerlink" title="直线回归的假设检验"></a>直线回归的假设检验</h3><p>直线回归必须检验，<strong>F检验和t检验</strong>都可以用于直线回归的假设检验</p>
<p>•根据方差分解的思想，我们也可以把y的总方差分解成，x引起的y的方差(称&#x3D;&#x3D;回归方差&#x3D;&#x3D;)和随机方差(称&#x3D;&#x3D;离回归方差&#x3D;&#x3D;)两部分。</p>
<p>如果回归方差显著大于离回归方差，那么说明x对y的影响大于随机误差，即y对x的回归关系是显著的，否则则说明回归关系不是显著的。</p>
<p>直线回归的平方和分解<br>$$<br>\sum(y-\overline y)^2&#x3D;\sum(\hat y-\overline y)^2+\sum(y-\hat y)^2\<br>左边y的离均差平方和，也称为总平方和SS_y\<br>第一项称回归平方和，记作U或SS_{回归}\<br>第二项称为离回归平方和，也称残差平方和（剩余平方和），记作Q,SS <em>{离回归}或SS</em>{剩余}<br>$$</p>
<p>$$<br>U&#x3D;\sum(\hat y-\overline y)^2\<br>&#x3D;b^2\sum(x-\overline x)^2&#x3D;b^2SS_x&#x3D;\frac{SP^2}{SS_x}\<br>Q&#x3D;SS_y-U<br>$$</p>
<h3 id="直线回归的自由度分解"><a href="#直线回归的自由度分解" class="headerlink" title="直线回归的自由度分解"></a>直线回归的自由度分解</h3><p>总自由度为n-1</p>
<p>一元直线回归，只涉及到一个自变量，所以回归平方和的自由度为1</p>
<p>离回归平方和的自由度等于以上两者之差n-2</p>
<hr>
<h3 id="直线回归的F检验"><a href="#直线回归的F检验" class="headerlink" title="直线回归的F检验"></a>直线回归的F检验</h3><p>因为方差等于平方和除以自由度：<br>$$<br>S^2_{回归}&#x3D;\frac{U}{1}\<br>S^2_{离回归}&#x3D;\frac{Q}{n-2}\<br>F&#x3D;\frac{S^2_{回归}}{S^2_{离回归}}\<br>若F值落在F分布的右尾拒绝区，则说明直线回归关系显著<br>$$</p>
<hr>
<h3 id="直线回归的t检验"><a href="#直线回归的t检验" class="headerlink" title="直线回归的t检验"></a>直线回归的t检验</h3><p>$Y&#x3D;\alpha+\beta X+\epsilon$</p>
<p>$\beta$等于零，那么y与x就没有关系</p>
<p>b的平均数是$\beta$<br>$$<br>S_b&#x3D;\frac{S_{离回归}}{\sqrt{SS_x}}\<br>t&#x3D;\frac{b-\beta}{S_b}&#x3D;\frac{b}{S_b}<br>(假设\beta&#x3D;0)<br>$$<br>若t落在$df&#x3D;n-2$的t分布的双尾拒绝区内说明$\beta$与0的差异显著，即直线回归关系显著。</p>
<p>F检验和t检验的本质完全相同。</p>
<hr>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131743839.png" alt="image-20220406105547440"></p>
<p>1.回归直线位于$\mu_{y&#x2F;x}$的置信区间的中间。</p>
<p>2.$\mu_{y&#x2F;x}$的置信区间位于y置信区间的中间。</p>
<p>3.随着x远离平均数时，置信区间越宽，即回归直线描述数据关系的适合度变差</p>
<h3 id="直线回归的应用注意"><a href="#直线回归的应用注意" class="headerlink" title="直线回归的应用注意"></a>直线回归的应用注意</h3><p>•1. 描述两个变量的依存关系。</p>
<p>•2. 在一定范围内，根据自变量对因变量进行预测。</p>
<p>•3. 通过控制自变量来控制因变量。</p>
<p>PS：要符合生物学意义，区分自变量和因变量，&#x3D;&#x3D;必须检验&#x3D;&#x3D;，外推要谨慎。</p>
<h2 id="直线相关"><a href="#直线相关" class="headerlink" title="直线相关"></a>直线相关</h2><p>•如果不需要区分自变量和因变量，只想了解两个变量的相关程度(degree of correlation)和相关性质(character of correlation)，则可以是使用&#x3D;&#x3D;相关系数&#x3D;&#x3D;(correlation coefficient)来描述。</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131743649.png" alt="image-20220406110202264"></p>
<p>相关系数</p>
<p>若使用样本资料时<br>$$<br>r&#x3D;\frac{\sum(x-\overline x)(y-\overline y)}<br>{\sqrt{\sum(x-\overline x)^2\sum(y-\overline y)^2}}<br>&#x3D;\frac{SP}{\sqrt{SS_xSS_y}}<br>&#x3D;\sqrt{\frac{U}{SS_y}}<br>$$<br>计算相关系数时，<strong>两个变量是平等的</strong>，不区分自变量和因变量，这是相关和回归的主要区别。</p>
<p>相关系数的是指就是回归平方和与总平方和比率的平方根，所以&#x3D;&#x3D;取值范围为[-1,1]&#x3D;&#x3D;。</p>
<p>决定系数<br>$$<br>r^2&#x3D;\frac{SP^2}{SS_xSS_y}<br>&#x3D;\frac{U}{SS_y}<br>$$<br>决定系数的含义是<strong>回归平方和占总平方和的比率</strong>，取值范围[0,1]。</p>
<h3 id="直线相关的相关系数假设检验"><a href="#直线相关的相关系数假设检验" class="headerlink" title="直线相关的相关系数假设检验"></a>直线相关的相关系数假设检验</h3><p>计算出相关系数以后，并不能说明两者真的相关，还<strong>必须使用假设检验来推断</strong>，根据样本资料计算的r的理论值ρ与0的差异是否显著。<br>$$<br>S_r&#x3D;\sqrt{\frac{1-r^2}{n-2}}\<br>t&#x3D;\frac{r-\rho}{S_r}<br>&#x3D;\frac{r}{S_r}<br>$$<br>如果t值落在$df&#x3D;n-2$的t分布的拒绝区，才说明相关是显著的。</p>
<p>•相关显著性检验的$t_r$与回归显著性检验的$t_b$是相等的，所以两个变量的<strong>回归系数和相关系数的t检验本质是完全相同的</strong>。</p>
<p>r临界值表，查询附表8，可以发现<strong>随着df的增大，r的临界值变小</strong>，也就是说为了发现弱相关性，必须<strong>样本足够大</strong>才行。</p>
<h3 id="直线相关的应用注意"><a href="#直线相关的应用注意" class="headerlink" title="直线相关的应用注意"></a>直线相关的应用注意</h3><p>•1. 两个变量应该都服从<strong>正态分布</strong>。</p>
<p>•2. 相关系数<strong>必须进行检验</strong>。</p>
<p>•3. 变量应尽可能多。</p>
<p>•4. 相关系数显著说明两个变量之间存在相关性，到底是因果关系还是平行关系要根据生物学知识进行判断。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>&#x3D;&#x3D;直线回归和直线相关有什么区别？&#x3D;&#x3D;</p>
<ol>
<li><p>直线回归需要区别自变量和因变量，自变量一般是代表原因的量，或者是可以严格控制的量，因变量应服从正态分布；直线相关则要求两者都服从正态分布，两者的地位是完全相同的。</p>
</li>
<li><p><strong>直线回归一般用于研究因果关系，而直线相关一般用于研究平行关系</strong>。</p>
</li>
<li><p>回归系数b取值范围是负无穷到正无穷，而相关系数r的取值范围是[-1,1]。</p>
</li>
<li><p>b越大，说明直线的斜率越大；|r|越大，说明散点距离直线越近，或者说直线方程的拟合程度越好。</p>
</li>
</ol>
<p>&#x3D;&#x3D;•直线回归和直线相关有什么联系？&#x3D;&#x3D;</p>
<p>•1. r和b的正负号一定是相同的。</p>
<p>•2. 假设检验是等价的。</p>
<p>•3. 直线回归的F检验过程中要计算总平方和和回归平方和，而$r^2$则是回归平方和与总平方和的比值。</p>
<p>•4. 若x和y均为正态分布时，也可以分别计算以x为自变量的回归系数，和以y为自变量的回归系数，且$r^2&#x3D;b_{x&#x2F;y}b_{y&#x2F;x}$。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/12/012Biostatistics-chapter6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/12/012Biostatistics-chapter6/" class="post-title-link" itemprop="url">Biostatistics生物统计学第六讲方差分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-12 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-12T09:25:00+08:00">2022-05-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:28" itemprop="dateModified" datetime="2023-03-23T21:51:28+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <hr>
<h1 id="第六讲-方差分析"><a href="#第六讲-方差分析" class="headerlink" title="第六讲 方差分析"></a>第六讲 方差分析</h1><blockquote>
<p><strong>第四章介绍了如何比较样本平均数与参考总体平均数，以及比较两个样本平均数。但如果有三个或更多的样本平均数</strong></p>
</blockquote>
<p>有三个或更多的样本平均数时，u检验&#x2F;t检验都有一定的局限，不适用</p>
<blockquote>
<p>本文有些数学公式使用md语法打的，刚学这个，有的嫌太累了:joy:直接用的图片</p>
</blockquote>
<h2 id="第一节-方差分析"><a href="#第一节-方差分析" class="headerlink" title="第一节 方差分析"></a>第一节 方差分析</h2><p>•方差分析(analysis of variance，ANOVA)又称变量分析，是把所有分组的观测值作为&#x3D;&#x3D;一个整体&#x3D;&#x3D;，一次性比较各组的样本平均数并做出推断。</p>
<p>•如果差异不显著，则认为各组都是相同的；如果差异显著，再进一步比较是哪组数据与其他数据不同。</p>
<table>
<thead>
<tr>
<th>因素factor</th>
<th>试验中所研究的影响试验指标的原因或原因组合。<strong>温度，湿度</strong></th>
</tr>
</thead>
<tbody><tr>
<td>水平level</td>
<td>每个因素的不同状态，温度（20℃、30℃、40℃）</td>
</tr>
<tr>
<td>处理treatment</td>
<td>对受试对象给予的某种外部干预，2种温度+3种湿度&#x3D;6种处理</td>
</tr>
<tr>
<td>重复repetition</td>
<td>在试验中，将同一种重复实施在不止一个实验单位上</td>
</tr>
<tr>
<td>效应effect</td>
<td>试验因素相对独立的作用，正效应&#x2F;负效应</td>
</tr>
<tr>
<td>互作interaction</td>
<td>两个或两个以上处理因素间相互作用所产生的效应</td>
</tr>
</tbody></table>
<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131735987.png" alt="2022-03-30_185756 [小 ]854-294" style="zoom:80%;" />

<table>
<thead>
<tr>
<th>方差分析的基本思想</th>
</tr>
</thead>
<tbody><tr>
<td>造成观测值发生不同的原因可以分为两大类</td>
</tr>
<tr>
<td>一类是**处理效应(treatment effect)**，是试验中对不同个体给予不同处理引起的</td>
</tr>
<tr>
<td>二类是**误差效应(error effect)**，是试验中偶然性因素的干扰和测量误差所致</td>
</tr>
<tr>
<td><strong>方差分析就是把所有观测值的&#x3D;&#x3D;总方差分解成处理方差和误差方差并相互比较&#x3D;&#x3D;，看处理效应是否显著大于误差效应</strong></td>
</tr>
</tbody></table>
<hr>
<p><strong>方差分析的观测值和平均数</strong></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131735384.png" alt="2022-03-30_190432 [小 ]854-350"></p>
<p>•如表，某试验有k个处理组，且每处理重复n次。</p>
<p>•那么可以计算出每组观测值的平均数$x_i$.，和所有观测的平均数$\overline{x_{..}}$。</p>
<hr>
<p><strong>方差分析的线性模型</strong></p>
<p>每一项观测值：<br>$$<br>x_{ij}&#x3D;\mu+T_i+\epsilon_{ij}<br>$$</p>
<p>如果用样本来估计参数:<br>$$<br>x_{ij}&#x3D;\overline{x_{..}}+t_i+e_{ij}<br>$$</p>
<hr>
<p><strong>处理效应的三种模型</strong></p>
<table>
<thead>
<tr>
<th>1. 固定模型(fixed model)：各个处理的效应是特异选择的可以人为控制的固定常量，是由固定因素引起的，且这些常量的和为0</th>
</tr>
</thead>
<tbody><tr>
<td>2. 随机模型(random model)：各个处理的效应不是常量，而是由随机因素所引起的随机变量，且这些变量服从正态分布N(0, $σ^2$)</td>
</tr>
<tr>
<td>3. 混合模型(mixed model)：在多因素试验中，既包括固定效应的试验因素，又包括随机效应的试验因素</td>
</tr>
<tr>
<td>三种模型的差异：平方和和自由度的计算是相同的，但统计数<strong>F的计算公式是不同的，对试验的设计和结果的解释也存在不同。</strong></td>
</tr>
<tr>
<td>固定模型侧重于<strong>效应值的估计和比较，而随机模型侧重于效应值的变异程度的估计和检验。</strong></td>
</tr>
<tr>
<td>对于单因素方差分析，<strong>因为不存在互作，固定模型和随机模型没有区别</strong></td>
</tr>
</tbody></table>
<hr>
<h3 id="方差分析的三大步骤："><a href="#方差分析的三大步骤：" class="headerlink" title="方差分析的三大步骤："></a><strong>方差分析的三大步骤</strong>：</h3><table>
<thead>
<tr>
<th>1. 计算方差**(&#x3D;&#x3D;平方和分解&#x3D;&#x3D;和&#x3D;&#x3D;自由度分解&#x3D;&#x3D;)。**</th>
<th>$s^2&#x3D;\frac{\sum(x_i-\overline{x})^2}{n-1}$<strong>计算离均差平方和，计算自由度，最后相除得方差</strong></th>
<th>方差就是离均差平方和除以&#x3D;&#x3D;自由度&#x3D;&#x3D;。|</th>
</tr>
</thead>
<tbody><tr>
<td>2. 计算统计数F。</td>
<td>$F&#x3D;\frac{S^2_t}{S^2_e}$</td>
<td></td>
</tr>
<tr>
<td>3. (<strong>若F检验结论是差异显著)多重比较。</strong></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h4 id="平方和分解"><a href="#平方和分解" class="headerlink" title="平方和分解"></a>平方和分解</h4><p>$$<br>K个组的数据累加，<br>\\sum_{i&#x3D;1}^k\sum_{j&#x3D;1}^n(x_{ij}-\overline{x_{..}})^2<br>&#x3D;\sum_{i&#x3D;1}^k\sum_{j&#x3D;1}^n(x_{ij}-\overline{x_{i.}})^2<br>+n\sum_{i&#x3D;1}^k(\overline{x_{i.}}-\overline{x_{..}})^2<br>$$</p>
<p>•上面等式左边项称为&#x3D;&#x3D;总平方和$SS_T$&#x3D;&#x3D;，反映所有数据距离总平均数的变异情况。</p>
<p>•右边第一项称为&#x3D;&#x3D;组内平方和$SS_e$&#x3D;&#x3D;，反映每组内部数据距离本组平均数的变异情况。</p>
<p>•右边第二项称为&#x3D;&#x3D;组间平方和$SS_t$&#x3D;&#x3D;，反映每组的组平均数距离总平均数的变异情况。<br>$$<br>令常数C&#x3D;\frac{T^2}{nk},\<br>SS_T&#x3D;\sum^k_{i&#x3D;1}\sum^n_{j&#x3D;1}x_{ij}^2-C\<br>SS_t&#x3D;\frac{1}{n}\sum^k_{i&#x3D;1}T_{i.}-C\<br>SS_e&#x3D;SS_T-SS_t<br>$$<br>$SS_T$就是所有观测值的平方的累加减去常数C；</p>
<p>$SS_t$就是每组观测值和的平方的累加除以n再减去常数C</p>
<h4 id="自由度分解"><a href="#自由度分解" class="headerlink" title="自由度分解"></a>自由度分解</h4><p>•k个分组，每组n次重复，总共$n_k$个观测值；</p>
<p>•总自由度$df_T&#x3D;n_k-1$</p>
<p>•组间自由度$df_t&#x3D;k-1$</p>
<p>•组内自由度$df_e&#x3D;k(n-1)&#x3D;df_T-df_t$</p>
<h4 id="计算方差"><a href="#计算方差" class="headerlink" title="计算方差"></a>计算方差</h4><p>$$<br>S^2_t&#x3D;\frac{SS_t}{df_t}\<br>S^2_e&#x3D;\frac{SS_e}{df_e}<br>$$</p>
<h4 id="F检验"><a href="#F检验" class="headerlink" title="F检验"></a>F检验</h4><p>$$<br>F&#x3D;<br>\frac{S^2_t}{S^2_e}<br>$$</p>
<p>•如果组间的总体方差等于组内的总体方差，那么上式就会落入F分布大概率区间内，如果落在小概率区间内，则认为假设不成立，即两个总体的方差不相等。</p>
<p>•方差分析时的F检验只有右尾检验，如果落入右尾拒绝区，说明处理效应显著大于误差效应，即组间有显著差别。</p>
<h4 id="多重比较"><a href="#多重比较" class="headerlink" title="多重比较"></a>多重比较</h4><p>•如果F检验否定了零假设，说明k个处理的平均数之间有显著差异，但并不意味着每两个处理的平均数间的差异都是显著的，也无法分别具体是哪些平均数间的差异是显著的。</p>
<p>•因此，就要进行多重比较。</p>
<table>
<thead>
<tr>
<th>最小显著差数法LSD法</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>标记字母法</td>
<td>不建议使用</td>
</tr>
<tr>
<td>梯形表示法</td>
<td>建议使用</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>最小显著极值法LSR法</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>新复极差检验(SSR法)</td>
<td></td>
</tr>
<tr>
<td>q检验(SNK法)</td>
<td></td>
</tr>
</tbody></table>
<h5 id="最小显著差数法"><a href="#最小显著差数法" class="headerlink" title="最小显著差数法"></a>最小显著差数法</h5><p>•统计学家Fisher最早提出了最小显著差数法，又称LSD法，其实质就是两个平均数相比较的t检验法。</p>
<p>•先计算出达到差异显著的最小差数，记为LSD，然后比较两个处理平均数的差值与LSD，如差值大于LSD，即认为差异显著。<br>$$<br>LSD_{0.05}&#x3D;t_{o.o5}\cdot s_{\overline{x_1}-\overline{x_2}}\<br>LSD_{0.01}&#x3D;t_{0.01}\cdot s_{\overline{x_1}-\overline{x_2}}\<br>其中s_{\overline{x_1}-\overline{x_2}}<br>&#x3D;\sqrt{S^2_e(\frac{1}{n_1}+\frac{1}{n_2})}\<br>t_{0.05}是自由度为df_e的t检验临界值\<br>若|\overline{x_1}-\overline{x_2}|&gt;LSD_{0.05},即为两者差异显著；\<br>若|\overline{x_1}-\overline{x_2}|&gt;LSD_{0.01},即为两者差异极显著；<br>$$</p>
<h6 id="标记字母法"><a href="#标记字母法" class="headerlink" title="标记字母法"></a>标记字母法</h6><p>•1. 把全部平均数从大到小依次排列；</p>
<p>•2. 在最大的平均数后标上a，然后依次向下比较，若不显著则也标上a，若遇到第一个显著则标上b，并停止比较。</p>
<p>•3. 以标有b的平均数为标准，依次向上比较，若不显著则在a的后面再加上b，直到遇见第一个显著时不做任何标记，并停止比较。</p>
<p>•4. 以标有b的最大平均数为标准，依次向下比较，若不显著则也标上b，若遇到第一个显著则标上c，并停止比较。</p>
<p>•5. 以此类推，反复进行，直到所有平均数都被标记了字母为止。</p>
<h6 id="梯形表示法"><a href="#梯形表示法" class="headerlink" title="梯形表示法"></a>梯形表示法</h6><p>•使用三角形阵列的格式展示出所有平均数差值，把各差值与LSD相比，*代表大于$LSD_{0.05}$，**代表大于$LSD_{0.01}$。</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131735307.png" alt="2022-03-30_211431 [小 ]854-246"></p>
<p>•结论：</p>
<p>•A1与A2和A4差异极显著，A1与A3差异显著；</p>
<p>•A3与A4差异极显著，A2与A4差异也极显著；</p>
<p>•A2和A3差异不显著。</p>
<p>&#x3D;&#x3D;LSD方法的局限&#x3D;&#x3D;</p>
<p>•LSD法的优点是比较简单，相对于t检验的优势是 把组内方差作为各组统一的试验误差。</p>
<p>•但是，仍有推断可靠性低，<strong>犯α错误概率增加</strong>的问题。</p>
<p>•多个处理平均数相互比较时，处理水平差异不同时，显著性阈值取相同标准不合理，应该做出适当调整。</p>
<h5 id="最小显著极值法"><a href="#最小显著极值法" class="headerlink" title="最小显著极值法"></a>最小显著极值法</h5><p>•最小显著极差法(LSR法)是在比较多个处理的数据时，根据处理平均数在按大小排序时的距离的不同，而采用不同的显著差数标准。</p>
<h6 id="SSR法"><a href="#SSR法" class="headerlink" title="SSR法"></a>SSR法</h6><p>•1. 在各样本容量相等时，计算平均数标准误：<br>$$<br>S_{\overline{x}}&#x3D;\sqrt{\frac{S^2_e}{n}}\<br>$$<br>•2. 查附表6中的SSR值，再计算最小显著差值：<br>$$<br>LSR_{\alpha}&#x3D;SSR_{\alpha}\cdot s_{\overline{x}}<br>$$<br>•SSR表有两个参数，一个是自由度，另一个是M值，M值表示按大小排列时的距离，两者相邻记为2，中间隔一个记为3，以此类推。</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131735184.png" alt="image-20220330212844596"></p>
<h6 id="q检验"><a href="#q检验" class="headerlink" title="q检验"></a>q检验</h6><p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131735603.png" alt="image-20220330213033897"></p>
<h5 id="多重比较的三种方法选择"><a href="#多重比较的三种方法选择" class="headerlink" title="多重比较的三种方法选择"></a>多重比较的三种方法选择</h5><p>•M&#x3D;2时，三种方法的显著性阈值相同；但M&gt;2时，LSD法的显著性阈值最小，而q检验法的显著性阈值最大。</p>
<p>•结论：</p>
<p>•当处理数为2时，三种方法结论一致；</p>
<p>•当处理数增加时，&#x3D;&#x3D;LSD法最灵敏(sensitive)&#x3D;&#x3D;，&#x3D;&#x3D;q检验法最保守(conservative)&#x3D;&#x3D;。</p>
<p>•因为α错误和β错误是此消彼长的关系，不可能同时下降，&#x3D;&#x3D;<strong>最容易犯α错误的是LSD法</strong>&#x3D;&#x3D;，而&#x3D;&#x3D;<strong>最容易犯β错误的是q检验法</strong>&#x3D;&#x3D;，所以根据不同试验中两种错误的重要性不同来选择不同方法。</p>
<h2 id="第二节-单因素-single-factor-方差分析"><a href="#第二节-单因素-single-factor-方差分析" class="headerlink" title="第二节 单因素(single factor)方差分析"></a>第二节 单因素(single factor)方差分析</h2><p>1.当各处理重复次数相等时，方差分析的步骤就是计算出下表中的各值，然后与附表5比较。</p>
<table>
<thead>
<tr>
<th></th>
<th>$df$</th>
<th>$SS$</th>
<th>$S^2$</th>
<th>$F$</th>
</tr>
</thead>
<tbody><tr>
<td>处理间</td>
<td>k-1</td>
<td>$SS_t&#x3D;\frac{1}{n}\sum_{i&#x3D;1}^kT_{i.}^2-C$</td>
<td>$S_t^2&#x3D;\frac{SS_t}{df_t}$</td>
<td>$\frac{S_t^2}{S_e^2}$</td>
</tr>
<tr>
<td>处理内</td>
<td>k(n-1)</td>
<td>$SS_e&#x3D;SS_T-SS_t$</td>
<td>$S_e^2&#x3D;\frac{SS_e}{df_e}$</td>
<td></td>
</tr>
<tr>
<td>总</td>
<td>nk-1</td>
<td>$SS_T&#x3D;\sum_{i&#x3D;1}^{k}\sum_{j&#x3D;1}^nx_{ij}^2-C$</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>2.组内重复次数不相等时</p>
<p>组内重复次数不相等时，仍然可以使用方差分析，不过计算公式稍有变化。•组内重复次数不相等的试验要尽量避免，因为这样的试验数据不仅计算麻烦，而且降低了分析的灵敏度。</p>
<h2 id="第三节-二因素方差分析"><a href="#第三节-二因素方差分析" class="headerlink" title="第三节 二因素方差分析"></a>第三节 二因素方差分析</h2><p>•对于有两个因素的试验，除了分析各因素的处理效应外，还需要考虑到因素间的<strong>互作效应</strong>。</p>
<p>•当互作效应非常大时，甚至可以忽略主效应。</p>
<p>•是否存在互作可以根据统计方法判断，也可以根据专业知识判断。</p>
<p>•<strong>只有每个处理都有重复的情况下，才能用统计方法分析互作效应。</strong></p>
<h3 id="处理无重复时"><a href="#处理无重复时" class="headerlink" title="处理无重复时"></a>处理无重复时</h3><p>•按照方差分析的思想，可以把所有观测值的方差分解成处理A效应方差、处理B效应方差和误差效应方差并相互比较。</p>
<h3 id="处理有重复时"><a href="#处理有重复时" class="headerlink" title="处理有重复时"></a>处理有重复时</h3><p>•如果A因素有a个水平，B因素有b个水平，且每个处理组合重复n次时，则A因素的每个水平总共有bn个重复，而B因素的每个水平总共有an个重复，总共有abn个观测值。</p>
<h4 id="平方和分解-1"><a href="#平方和分解-1" class="headerlink" title="平方和分解"></a>平方和分解</h4><p>$$<br>C&#x3D;\frac{T^2}{abn}<br>$$</p>
<h4 id="自由度分解-1"><a href="#自由度分解-1" class="headerlink" title="自由度分解"></a>自由度分解</h4><p>•总自由度$df_T&#x3D;abn-1$</p>
<p>•因素A自由度$df_A&#x3D;a-1$</p>
<p>•因素B自由度$df_B&#x3D;b-1$</p>
<p>•AB互作自由度$df_{AB}&#x3D;(a-1)(b-1)$</p>
<p>•组内随机误差自由度$df_e&#x3D;ab(n-1)$</p>
<h4 id="计算方差-1"><a href="#计算方差-1" class="headerlink" title="计算方差"></a>计算方差</h4><p>$$<br>S^2_A&#x3D;\frac{SS_A}{df_A}\<br>S^2_B&#x3D;\frac{SS_B}{df_B}\<br>S^2_{AB}&#x3D;\frac{SS_{AB}}{df_{AB}}\<br>S^2_e&#x3D;\frac{SS_e}{df_e}<br>$$</p>
<h4 id="F检验-1"><a href="#F检验-1" class="headerlink" title="F检验"></a>F检验</h4><p>•对于AB互作效应：<br>$$<br>F_{AB}&#x3D;\frac{S^2_{AB}}{S^2_e}<br>$$<br>•若A或B为固定因素时：<br>$$<br>F_A&#x3D;\frac{S^2_{A}}{S^2_e}<br>,<br>F_B&#x3D;\frac{S^2_{B}}{S^2_e}<br>$$<br>•若A或B为随机因素时：<br>$$<br>F_A&#x3D;\frac{S^2_{A}}{S^2_{AB}}<br>,<br>F_B&#x3D;\frac{S^2_{B}}{S^2_{AB}}<br>$$</p>
<h4 id="二因素方差分析总结"><a href="#二因素方差分析总结" class="headerlink" title="二因素方差分析总结"></a>二因素方差分析总结</h4><p>具重复观测值得二因素资料方差分析表</p>
<table>
<thead>
<tr>
<th align="left">变异来源</th>
<th>$SS$</th>
<th>$df$</th>
<th>$s^2$</th>
</tr>
</thead>
<tbody><tr>
<td align="left">因素A</td>
<td>$SS_A$</td>
<td>$a-1$</td>
<td>$s^2_A$</td>
</tr>
<tr>
<td align="left">因素B</td>
<td>$SS_B$</td>
<td>$b-1$</td>
<td>$s^2_B$</td>
</tr>
<tr>
<td align="left">$A\times B$</td>
<td>$SS_{AB}$</td>
<td>$(a-1)(b-1)$</td>
<td>$s^2_{AB}$</td>
</tr>
<tr>
<td align="left">误差</td>
<td>$SS_e$</td>
<td>$ab(n-1)$</td>
<td>$s^2_e$</td>
</tr>
<tr>
<td align="left">总变异</td>
<td>$SS_T$</td>
<td>$abn-1$</td>
<td></td>
</tr>
</tbody></table>
<h2 id="第四节-多因素方差分析"><a href="#第四节-多因素方差分析" class="headerlink" title="第四节 多因素方差分析"></a>第四节 多因素方差分析</h2><p>•其实就是把二因素方差分析扩展到一般情况。</p>
<p>•此时，总方差可以分解成各因素的主效应误差，因素两两之间的互作效应误差，因素三三之间的互作效应误差，……，以及随机误差。</p>
<h2 id="第六节-方差分析应满足的三个条件"><a href="#第六节-方差分析应满足的三个条件" class="headerlink" title="第六节 方差分析应满足的三个条件"></a>第六节 方差分析应满足的三个条件</h2><p>•1. <strong>可加性</strong>。处理效应与误差效应是可加的。</p>
<p>•2. <strong>正态性</strong>。试验误差应当服从正态分布N(0，$σ^2$)，也就是说被检验的每一个总体都是正态分布。</p>
<p>•3. <strong>方差齐性</strong>。各处理的误差方差均为$σ^2$。</p>
<p>•以上三个条件中，影响最大的是方差齐性，因此在做方差分析前应该先进行方差齐性检验。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/11/011Biostatistics-chapter1-5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Long Chen">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="陈功的小博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/11/011Biostatistics-chapter1-5/" class="post-title-link" itemprop="url">Biostatistics课程学习笔记Chapter1-5</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-05-11 09:25:00" itemprop="dateCreated datePublished" datetime="2022-05-11T09:25:00+08:00">2022-05-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-23 21:51:27" itemprop="dateModified" datetime="2023-03-23T21:51:27+08:00">2023-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">课程笔记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="生物统计学-biostatistics"><a href="#生物统计学-biostatistics" class="headerlink" title="生物统计学(biostatistics)"></a>生物统计学(biostatistics)</h1><h2 id="第一章绪论"><a href="#第一章绪论" class="headerlink" title="第一章绪论"></a>第一章绪论</h2><blockquote>
<p><em><strong>定义</strong></em>：<strong>用数理统计的原理和方法来分析和解释生物界各种现象和试验调查资料的一门学科</strong></p>
</blockquote>
<blockquote>
<p>生物的特点：随机性、变异性、复杂性</p>
</blockquote>
<h3 id="常用统计学术语"><a href="#常用统计学术语" class="headerlink" title="常用统计学术语"></a>常用统计学术语</h3><p>•同质(homogeneity)：根据研究目的所确定的观察单位其性质应大致相同。</p>
<p>•变异(variation)：即使性质相同的事物，由于存在个体差异，同一指标的测量结果也不同。</p>
<p>•总体(population)：具有相同性质的个体所组成的集合，指研究对象的全体。（有限总体、无限总体）</p>
<p>•个体(individual)：组成总体的基本单位。</p>
<p>•样本(sample)：从总体中抽出的有代表性的若干个体所构成的集合。（通常把n≤30的样本叫小样本， n&gt;30的样本叫大样本）</p>
<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131731199.png" alt="image-20220320151429330" style="zoom:33%;" />

<p>•参数(参量)(parameter)：对一个总体特征的度量。•常用希腊字母表示μ、σ</p>
<p>•统计数(统计量)(statistic)：由样本计算所得的数值。•常用英文字母表示<strong>s、x</strong></p>
<p>•变量(variable)：相同性质的事物间表现差异性的某项特征或者性状。</p>
<p>•常量(constant)：对总体来说不会变化的变量，例如总体平均数等。</p>
<p>•因素(factor)：试验中所研究的影响试验指标的原因或原因组合。</p>
<p>•(因素)水平(level)：每个因素的不同状态。</p>
<p>处理(treatment)与重复(repetition)、效应(effect)与互作(interaction)、准确性(accuracy)与精确性(precision)、误差(error)与错误(mistake)、概率(probability)</p>
<blockquote>
<p>生物统计学的内容</p>
</blockquote>
<h3 id="试验设计-experimental-design"><a href="#试验设计-experimental-design" class="headerlink" title="试验设计(experimental design)"></a>试验设计(experimental design)</h3><p>•取样是否有代表性？是否随机？对照、重复、几个因素、几个水平、是否排除无关因素</p>
<p><strong>统计分析(statistical analysis)</strong></p>
<table>
<thead>
<tr>
<th align="left"><strong>数据整理</strong></th>
<th align="center"><strong>数据检查</strong></th>
<th align="center"><strong>变量转换</strong></th>
<th align="center"><strong>数据分布</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>统计描述</strong></td>
<td align="center"><strong>统计指标</strong></td>
<td align="center"><strong>统计表</strong></td>
<td align="center"><strong>统计图</strong></td>
</tr>
<tr>
<td align="left"><strong>统计推断</strong></td>
<td align="center"><strong>参数估计</strong></td>
<td align="center"><strong>假设检验</strong></td>
<td align="center"><strong>方差分析等</strong></td>
</tr>
</tbody></table>
<p><strong>•SPSS(statistical package for the social sciences)</strong></p>
<hr>
<h2 id="第二章资料整理与特征数计算"><a href="#第二章资料整理与特征数计算" class="headerlink" title="第二章资料整理与特征数计算"></a>第二章资料整理与特征数计算</h2><h3 id="资料的类型"><a href="#资料的类型" class="headerlink" title="资料的类型"></a>资料的类型</h3><p>资料(data)：在生物学试验及调查中能够获得大量的原始数据，是在一定条件下对某种具体事物或现象观察的结果，称之为<strong>资料。资料就是变量的值</strong>。</p>
<table>
<thead>
<tr>
<th><strong>对某种现象</strong>只能观察不能测量的资料</th>
<th><strong>一般是由</strong>计数和测量<strong>得到的。</strong></th>
</tr>
</thead>
<tbody><tr>
<td>质量性状(qualitative character)资料</td>
<td>数量性状(quantitative character)资料</td>
</tr>
<tr>
<td>花瓣的颜色</td>
<td>鱼尾数，玉米籽粒数</td>
</tr>
<tr>
<td>治疗疾病的痊愈，好转</td>
<td>高度，重量</td>
</tr>
</tbody></table>
<blockquote>
<p>•<strong>生物统计学归根结底就是用样本来估计总体的问题，所以统计分析的基础就是样本的搜集。</strong></p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131731791.png" alt="image-20220320172117236"></p>
<p>试验(experiment):•对一定数量的有代表性试验单位，在一定条件下进行有探索性的研究工作。<strong>遵循随机、重复和局部控制三项基本原则</strong></p>
<h3 id="资料的整理"><a href="#资料的整理" class="headerlink" title="资料的整理"></a>资料的整理</h3><p>更正缺失数据、重复值和异常值</p>
<p>利用SPSS软件绘制</p>
<p>频数分布表(frenqucy table)、条形图(bar chart)、直方图(histogram)、饼图(pie chart)、散点图(scatter chart)</p>
<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131731297.png" alt="image-20220320173010069" style="zoom:50%;" />

<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131731802.png" alt="image-20220320173049457" style="zoom:50%;" />

<h3 id="资料特征数的计算"><a href="#资料特征数的计算" class="headerlink" title="资料特征数的计算"></a>资料特征数的计算</h3><p><strong>变量的分布具有两个明显的基本特征</strong></p>
<p><strong>集中性</strong>(centrality)•反映集中性的特征数是平均数。</p>
<p><strong>离散性</strong>(discreteness)•反映离散性的特征数是变异数。</p>
<p>平均数(mean)：算术平均数、中位数、众数、几何平均数(geometric mean)</p>
<p>中位数(median)、众数(mode):<strong>适用于服从偏态分布的数据</strong></p>
<p>变异数(variance)：<strong>极差</strong>(range)、<strong>方差</strong>(variance)、<strong>标准差</strong>(standard deviation)、<strong>四分位数间距</strong>(quartile range)、<strong>变异系数</strong>(coefficient of variability)</p>
<p>标准差是衡量变量资料变异程度的<strong>最好指标</strong></p>
<p>•1. 标准差受到<strong>所有观测值的影响。</strong></p>
<p>•2. 将各观测值减去一个常数a，其标准差不变；将各观测值乘以一个常数a，其标准差扩大了a倍。</p>
<p>•3. 标准差和平均数一样，与观测值具有相同的<strong>单位。</strong></p>
<p>•4. 因为利用了算术平均数，所以同样不适合<strong>偏态分布。</strong></p>
<p>Q1，Q2和Q3恰好把资料分成四个相同大小的组分，所以叫四分位数，•<strong>四分位数间距Q&#x3D;Q3-Q1。</strong></p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131732264.png" alt="img"></p>
<p>**变异系数<u>没有单位</u>**：标准差除以样本平均数乘以100%</p>
<p><strong>算术平均数总是大于几何平均数</strong></p>
<h2 id="第三章概率分布"><a href="#第三章概率分布" class="headerlink" title="第三章概率分布"></a>第三章概率分布</h2><blockquote>
<p><strong>生物统计学最主要的任务是用样本统计数来推断其所属总体的参数</strong></p>
<p><strong>从同一总体中随机抽取样本，每次得到的样本不会完全相同，用不同样本去推断同一总体将得到不同的结论，如何判断这些结论的可靠性</strong></p>
<p>•这些推断的基础是关于<strong>概率分布的基本知识，以及抽样分布。</strong></p>
</blockquote>
<h3 id="概率基础知识"><a href="#概率基础知识" class="headerlink" title="概率基础知识"></a>概率基础知识</h3><ol>
<li><p>•必然事件**(certain event)，以U表示。**</p>
</li>
<li><p>•不可能事件**(impossible event)，以V表示。**</p>
</li>
<li><p>•随机事件**(random event，简称事件)，指在某些确定条件下，因为偶然因素的影响而可能出现也可能不出现的现象。**</p>
</li>
<li><p>和事件(sum event):<strong>A+B</strong>至少有一件事发生</p>
</li>
<li><p>积事件(product event)：<strong>A·B</strong>多个事件<strong>同时发生</strong></p>
</li>
<li><p>互斥事件(mutually exclusive event)：<strong>A·B&#x3D;V</strong>，不可能同时发生</p>
</li>
<li><p>对立事件(contrary event)：<strong>A+B&#x3D;U，A·B&#x3D;V</strong>，必有一件事发生</p>
</li>
<li><p>完全事件系(complete event system)：A**1+A2+……+An&#x3D;U，Ai·Aj&#x3D;V(当i不等于j时)**，多个事件两两相斥</p>
</li>
<li><p>独立事件(independent event)：两者毫无关系</p>
</li>
<li><p>加法定理<strong>P(A+B)&#x3D;P(A)+P(B)-P(A·B)</strong></p>
</li>
<li><p>乘法定理<strong>P(A·B)&#x3D;P(A|B)·P(B)&#x3D; P(B|A)·P(A)</strong></p>
</li>
<li><p>频率(frequency)：<strong>即某事件发生的次数除以重复试验次数</strong></p>
</li>
<li><p>概率(probability)：随着重复试验次数不断增大，某事件发生的频率越来越接近某一固定值p，p就定义为该事件发生的概率。（一般情况下，因为重复试验的次数是有限的，所以<strong>频率只是概率的一个近似值。</strong>）</p>
<p>•<strong>频率是试验中真实观察到的概率，概率是理论上的频率。</strong></p>
<p>•<strong>频率是样本的统计数，概率是总体的参数。</strong></p>
</li>
</ol>
<h3 id="概率分布（已知总体推样本）"><a href="#概率分布（已知总体推样本）" class="headerlink" title="概率分布（已知总体推样本）"></a>概率分布（已知总体推样本）</h3><p>概率分布**(probability distribution)：**随机变量的取值与取这些值的概率之间的对应关系</p>
<p>离散型变量的分布：二项分布、泊松分布<strong>……</strong></p>
<p>连续型变量的分布：正态分布、<strong>t分布、卡方分布、F分布</strong></p>
<p>二项分布(binomial distribution)：<strong>结果只有两种情况的事件组成的总体的概率分布</strong>，<strong>试验具有重复性和独立性</strong>		<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131732085.png" alt="image-20220320190042568" style="zoom: 50%;" /></p>
<p>泊松分布(poisson distribution)：就是p值很小，但n值很大的特殊情况的二项分布</p>
<p>​		<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131732905.png" alt="image-20220325203604144" style="zoom: 50%;" /></p>
<p>​	•泊松分布的平均数和方差均为λ。</p>
<p>​	<strong>•二项分布当p&lt;0.1且np&lt;5时</strong>，可以用泊松分布来近似计算。</p>
<p>​	•泊松分布的形状参数λ无限增大时，泊松分布接近正态分布。</p>
<p>正态分布(normal distribution)：<strong>随机误差****一般服从正态分布</strong></p>
<p>​		<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131732070.png" alt="image-20220320191202699" style="zoom:50%;" /></p>
<p>​		•该正态分布记为N(μ, σ2)，其中μ是正态分布的平均数，σ是正态分布的标准差。</p>
<p>​		•变量落在 (μ-σ, μ+σ)范围内的概率是68.26%；</p>
<p>​		•变量落在(μ-2σ, μ+2σ)范围内的概率是95.45%。</p>
<p>​		μ决定f(x)的位置，μ增大，曲线右移。</p>
<p>​		σ决定f(x)的性状，σ增大，曲线越宽矮。</p>
<p>•P(-1.96&lt;x&lt;1.96)&#x3D;0.95•P(-2.58&lt;x&lt;2.58)&#x3D;0.99</p>
<blockquote>
<p><strong>生物统计学的研究包含两个过程：从总体抽取样本的过程，从样本统计数推断总体参数的过程</strong></p>
</blockquote>
<p>重置抽样也称“回置抽样”、“重复抽样”或“有<strong>放回的抽样”</strong></p>
<h4 id="若只有一个总体"><a href="#若只有一个总体" class="headerlink" title="若只有一个总体"></a>若只有一个总体</h4><blockquote>
<p>样本平均数分布性质</p>
<p>（1）样本平均数分布的平均数等于总体平均数</p>
<p>（2）样本平均数分布的方差等于总体方差<em><strong>除以样本容量</strong></em></p>
</blockquote>
<table>
<thead>
<tr>
<th>只有一个总体</th>
<th>有两个总体</th>
</tr>
</thead>
<tbody><tr>
<td>u分布（标准正态分布）</td>
<td>已知总体方差时，u检验可以用于比较总体平均数</td>
</tr>
<tr>
<td>t分布（从平均数μ，标准差未知的正态总体中，随机抽取含量为n的样本）</td>
<td>已知样本方差时，t检验可以用于比较总体平均数</td>
</tr>
<tr>
<td>卡方分布（μ，σ的正态总体中，独立随机地抽取k个含量为n的样本）</td>
<td>已知两个总体的标准差时，F检验可以用于比较总体的方差</td>
</tr>
</tbody></table>
<hr>
<p>u分布：当μ&#x3D;0，σ&#x3D;1时，N(0，1)被称为标准正态分布，又称为u分布，F(u)</p>
<p>t分布:不服从正态分布，服从自由度为n-1,是从平均数为μ，&#x3D;&#x3D;样本容量不大&#x3D;&#x3D;*&#x3D;&#x3D;标准差未知&#x3D;&#x3D;*的正态总体中，独立随机地抽取含量为n的样本产生的分布。</p>
<p>卡方分布：从平均数为μ，标准差为σ的正态总体中，独立随机地抽取k个含量为n的样本</p>
<p>​		•卡方分布的取值范围是0到正无穷；</p>
<p>​		•曲线不对称，峰值偏左(特别在df&#x3D;1时，曲线以y轴为渐近线)。</p>
<p>​		•随着自由度df增大，卡方分布趋于左右对称直至正态分布。</p>
<h4 id="若需要比较两个总体"><a href="#若需要比较两个总体" class="headerlink" title="若需要比较两个总体"></a>若需要比较两个总体</h4><blockquote>
<p>样本平均数差数分布的基本性质</p>
<p>（1）样本平均数差数的平均数等于总体平均数的差数（或样本平均数分布的平均数的差数）</p>
<p>（2）样本平均数差数的方差等于总体方差除以各自样本容量之和（或两样本平均数方差之和）</p>
</blockquote>
<p>设从一正态总体N（μ，$σ^2$)中随机抽取样本容量为$n_1$和$n_2$的两个独立样本，其样本方差为$s_1^2$和$s_2^2$，则定义$s_1^2$和$s_2^2$的比值为F：</p>
<p>$$<br>F&#x3D;<br>\frac{s{_1}{^2}}{s{_2}{^2}}<br>$$<br>•在已知<strong>总体方差时，u检验可以用于比较总体平均数。</strong></p>
<p>•在已知<strong>样本方差时，t检验可以用于比较总体平均数。</strong></p>
<p><strong>若两个总体的标准差已知</strong></p>
<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131732670.png" alt="image-20220325203852495" style="zoom:50%;" />

<p>•当σ<strong>1与σ2相等时，F可以简化为两个样本方差的比值。</strong></p>
<p>•F<strong>检验可以用于比较总体的方差。</strong></p>
<p>•F<strong>分布的取值范围是0到正无穷；</strong></p>
<p>•F<strong>分布的平均数趋向1；</strong></p>
<p>•曲线不对称<strong>，峰值偏左(特别在df1&#x3D;1或2时，曲线以y轴为渐近线)。</strong></p>
<p>•曲线性状仅取决于<strong>df1和df2。</strong></p>
<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131732547.png" alt="image-20220325203939618" style="zoom:50%;" />



<h2 id="第四章统计推断（已知样本推总体"><a href="#第四章统计推断（已知样本推总体" class="headerlink" title="第四章统计推断（已知样本推总体)"></a>第四章统计推断（已知样本推总体)</h2><blockquote>
<p>上一章我们讨论了已知总体的时候样本的特征，即<strong>抽样分布。</strong></p>
</blockquote>
<blockquote>
<p>本章我们来讨论已知样本的时候如何<strong>推断总体的特征，主要任务是分析差异产生的原因，是随机误差导致的，还是一些处理效应导致的。</strong></p>
</blockquote>
<h3 id="假设检验的原理与方法"><a href="#假设检验的原理与方法" class="headerlink" title="假设检验的原理与方法"></a>假设检验的原理与方法</h3><p>假设检验(hypothesis test)：也叫显著性检验(significance test)，是根据总体的理论分布和小概率原理，对&#x3D;&#x3D;未知或不完全知道的总体&#x3D;&#x3D;提出&#x3D;&#x3D;两种&#x3D;&#x3D;彼此对立的假设，然后由样本的实际结果，经过一定的计算，做出在一定概率意义上应该接受哪种假设的推断。</p>
<p>假设检验的步骤</p>
<p><strong>1.</strong> <strong>提出假设</strong></p>
<p>零假设(null hypothesis)也称无效假设，是指处理效应没有产生真实的差异，即差异都是随机误差导致的。</p>
<p>备择假设(alternative hypothesis)，是指处理效应产生了真实的差异。</p>
<p><strong>2.</strong> <strong>确定显著水平</strong></p>
<p>显著水平(significance level)是人为规定的小概率界限，用α表示，常用取值是0.05或0.01，特殊情况时也可以取其他值。</p>
<p>α也是假阳性发生的概率，及<strong>I</strong>型错误的发生率</p>
<p><strong>3.</strong> <strong>计算统计数与相应的概率</strong></p>
<p>在假定零假设正确的前提下，选择恰当的<strong>抽样分布相关公式</strong>计算标准化后的统计数，然后<strong>查表</strong>找到对应的概率累积函数值。</p>
<p><strong>4.</strong> <strong>推断是否接受假设</strong></p>
<p>推断的基础是小概率原理，即认为小概率事件在一次抽样试验中几乎是不可能发生的</p>
<p><strong>双尾检验和单尾检验</strong></p>
<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131732671.png" alt="image-20220325204101665" style="zoom:67%;" />

<table>
<thead>
<tr>
<th>零假设</th>
<th>备择假设</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>差值等于0</td>
<td>差值不等于0</td>
<td>u**&lt;-$\frac{u{_α}}{2}$和u&gt;$\frac{u{_α}}{2}$两个区域，所以叫双尾检验**</td>
</tr>
<tr>
<td></td>
<td>差值大于0</td>
<td>u**&gt;$u_α$区域**,单尾检验</td>
</tr>
<tr>
<td></td>
<td>差值小于0</td>
<td>u**&lt;-$u_α$区域**，单尾检验</td>
</tr>
<tr>
<td></td>
<td></td>
<td>&#x3D;&#x3D;单尾检验灵敏度高&#x3D;&#x3D;，一般用单尾</td>
</tr>
</tbody></table>
<p>假设检验的两类错误</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733780.png" alt="image-20220325204122095"></p>
<p>I型错误，也常称为α错误，弃真错误或&#x3D;&#x3D;假阳性&#x3D;&#x3D;错误。发生概率<strong>α</strong></p>
<p>II型错误，也常称为β错误，取伪错误或&#x3D;&#x3D;假阴性&#x3D;&#x3D;错误。概率与<strong>两个总体的分布情况</strong>有关，也与显著水平<strong>α</strong>有关</p>
<p>如何减少II型错误：</p>
<p>（1）α越大，β越小（不可取）</p>
<p>（2）两个μ的差值越大，β越小（比如采用更有效的药物）</p>
<p>（3）备择曲线的σ值越小，β越小(样本越集中)</p>
<p>（4）为了少犯β错误，<strong>增加样本容量</strong>是最有效的办法</p>
<h3 id="样本方差的同质性检验"><a href="#样本方差的同质性检验" class="headerlink" title="样本方差的同质性检验"></a>样本方差的同质性检验</h3><p>方差的同质性(又称方差齐性，homogeneity of variance)，就是指各个总体的方差是相同的</p>
<p>•方差同质性检验就是要从<strong>各样本的方差</strong>来判断其总体方差是否相同。</p>
<table>
<thead>
<tr>
<th>比较一个样本所属总体的方差与参考总体的方差有无显著差异</th>
<th>比较两个样本所属总体的方差与参考总体的方差有无显著差异</th>
</tr>
</thead>
<tbody><tr>
<td>卡方检验</td>
<td>F检验</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>一、比较一个样本所属总体的方差与参考总体的方差有无显著差异，使用<strong>卡方检验</strong></p>
<p><strong>例题</strong>•已知正常农田铅浓度的方差0.065(μg&#x2F;g)2，某农田经抽样8份，测定其铅浓度的方差0.15(μg&#x2F;g)2，问该农田铅浓度的方差与正常农田是否相同。</p>
<p>•(1)零假设两者铅浓度的方差无差别，即某农田的铅浓度的方差正常。</p>
<p>•(2)显著性水平α取0.05</p>
<p>•**(3)计算**<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733080.png" alt="image-20220324152216664"></p>
<p>• df&#x3D;n-1&#x3D;7时，卡方检验右尾检验的拒绝区是卡方大于14.07，16.154落在拒绝区内。</p>
<p>•(4) 结论：拒绝零假设，认为两者铅浓度的方差有显著差别，且该农田铅浓度的方差高于正常值。</p>
<p>二、 比较两个样本所属总体的方差与参考总体的方差有无显著差异，使用<strong>F检验</strong></p>
<p><strong>例题</strong>•小麦品种甲抽样10次，其千粒重的方差是22.933，小麦品种乙抽样10次，其千粒重的方差是2.933，问两个品种的千粒重的方差是否相同。</p>
<p>•(1)零假设两者千粒重的方差无差别。</p>
<p>•(2)显著性水平α取0.05。</p>
<p>•(3)计算<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733414.png" alt="image-20220324152801760"></p>
<p>• df1&#x3D;n-1&#x3D;9，df2&#x3D;n-1&#x3D;9时，F检验右尾检验的拒绝区是F&gt;3.18，7.819落在拒绝区内。</p>
<p>•(4) 结论：拒绝零假设，认为两者千粒重的方差有显著差别，且品种甲的方差高于品种乙。</p>
<h3 id="样本平均数的假设检验"><a href="#样本平均数的假设检验" class="headerlink" title="样本平均数的假设检验"></a>样本平均数的假设检验</h3><table>
<thead>
<tr>
<th>一个样本平均数的假设检验总结</th>
<th>两个样本平均数的假设检验总结</th>
</tr>
</thead>
<tbody><tr>
<td>比较样本所属总体和参考总体的平均数，且参考总体的<strong>方差已知</strong>，用u检验</td>
<td>比较两个样本所属总体的平均数，且两个总体的<strong>方差已知</strong>，用u检验</td>
</tr>
<tr>
<td>比较样本所属总体和参考总体的平均数，且参考总体的<strong>方差未知</strong>，用t检验，但在样本容量较大(≥30)时，t检验和u检验几乎没有区别</td>
<td>比较两个样本所属总体的平均数，且两个总体的<strong>方差未知</strong>，但在两个样本容量都较大(<strong>≥30</strong>)时，可以用u检验简化计算</td>
</tr>
<tr>
<td></td>
<td>比较两个样本所属总体的平均数，且两个总体的方差未知，样本容量较小时应使用t检验，可以分成三种情况：&#x3D;&#x3D;方差相等，样本容量相等或两者均不相等&#x3D;&#x3D;</td>
</tr>
<tr>
<td></td>
<td>对于成对数据，其实可以转化成一个样本平均数的假设检验，服从df&#x3D;n-1的t分布，当n足够大时，可以简化为u检验。</td>
</tr>
</tbody></table>
<h3 id="参数估计"><a href="#参数估计" class="headerlink" title="参数估计"></a>参数估计</h3><p>参数估计是指由样本结果对总体参数在一定概率水平下所做出的估计。</p>
<p>其实，参数估计就是统计推断相反的运算过程；</p>
<p>统计推断是已知μ，求u或t的值；</p>
<p>参数估计就是已知u或t，求μ的值。</p>
<p><strong>例题</strong>•测得某批25个小麦样本的平均蛋白质含量为14.5%。</p>
<p>•(1)正常小麦的蛋白质含量为14%，标准差为2.50%，请问该样本是否正常？</p>
<p>•(2)求该批蛋白质含量的95%置信区间。</p>
<p>•(1) 零假设该样本蛋白质含量等于14%，备择假设该样本蛋白质含量不等于14%。</p>
<p>•显著性水平α取0.05</p>
<p>•标准化计算</p>
<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733493.png" alt="image-20220325204226729" style="zoom:50%;" />

<p>接受零假设，该样本与正常小麦样本无差别</p>
<p>•(2) 求95%置信区间，即</p>
<p>•<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733652.png" alt="image-20220324161141867" style="zoom:50%;" /></p>
<p>•经计算可得μ&#x3D;13.52或15.48。</p>
<p>•即该批蛋白含量的95%置信区间为13.52%~15.48%(区间估计)，也可以写成14.5±0.98(点估计)。</p>
<p>•显然这个区间包括了14%，从另一个角度验证了上一小题的结论是正确的。</p>
<h2 id="第五章卡方检验"><a href="#第五章卡方检验" class="headerlink" title="第五章卡方检验"></a>第五章卡方检验</h2><blockquote>
<p>不是所有的样本都可以计算平均数和方差的；</p>
<p>例如属性资料的样本，和一些计数资料的样本</p>
</blockquote>
<table>
<thead>
<tr>
<th>属性资料</th>
<th>计数资料</th>
</tr>
</thead>
<tbody><tr>
<td>用1. 统计次数法；2. 评分法</td>
<td>服从二项分布，则可以利用二项分布的公式来研究其概率分布，有时可近似成正态分布</td>
</tr>
<tr>
<td>将其转化为计数资料</td>
<td>无论是否服从二项分布，都可以使用<strong>χ2检验</strong>来研究其概率分布</td>
</tr>
</tbody></table>
<p>χ2检验(chi-square test)</p>
<p>①一个样本的方差同质性检验；</p>
<p>②适合性检验；只有右尾检验</p>
<p>③独立性检验；只有右尾检验</p>
<p><img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733964.png" alt="image-20220324162959712"></p>
<p>•对于计数资料或属性资料，其观测值Oi与理论值Ei通过以上公式计算后，应该趋向于服从自由度df&#x3D;k-1的χ2分布。</p>
<p>•如果观测值Oi偏离理论值Ei，χ2增大，与χ2分布只有右侧拖着长尾吻合；</p>
<h3 id="χ2检验的步骤"><a href="#χ2检验的步骤" class="headerlink" title="χ2检验的步骤"></a>χ2检验的步骤</h3><p>•1. 提出零假设：观测值等于理论值，或者说两者的差异是由抽样误差引起的；备择假设：观测值不等于理论值，即两者的差异是真实存在的。</p>
<p>•2. 确定显著水平α，一般取0.05或0.01。</p>
<p>•3. 根据公式计算χ2。</p>
<p>•4. 进行统计推断。从附表4查出χ2α的值，如果χ2大于χ2α，则拒绝零假设；否则接受零假设。</p>
<p>PS:</p>
<ol>
<li><p>理论值非常小时，上式计算的χ2将偏离χ2分布，所以在&#x3D;&#x3D;Ei≤5时，需要进行并组&#x3D;&#x3D;；</p>
</li>
<li><p>在&#x3D;&#x3D;自由度df&#x3D;1时&#x3D;&#x3D;，需要进行连续性矫正；当df＞1时，是否进行连续性矫正差别不大。</p>
<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733392.png" alt="image-20220325204402044" style="zoom:67%;" /></li>
</ol>
<table>
<thead>
<tr>
<th>适合性检验<strong>compatibility test</strong></th>
<th>独立性检验</th>
</tr>
</thead>
<tbody><tr>
<td>比较观测值与理论值是否符合的假设检验，也叫拟合优度检验(goodness of fit test)</td>
<td>独立性检验是研究两个或两个以上因子彼此之间是相互独立的还是相互影响的一类统计方法，也理解成两个样本之间的适合性检验。</td>
</tr>
<tr>
<td><strong>二项分布</strong>的适合性检验根据二项分布公式计算理论频数 注意理论值≤5时应该并组。<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733528.png" alt="image-20220325204446335" style="zoom:25%;" />&#x3D;&#x3D;通过样本估计了一个参数，需要df-1&#x3D;&#x3D;</td>
<td>自由度df&#x3D;(r-1)(c-1)</td>
</tr>
<tr>
<td><strong>正态分布</strong>的适合性检验先根据频数分布表，计算样本的平均数和方差<img src="https://raw.githubusercontent.com/Cling5899/Personal_Typora_img/master/img/202205131733074.png" alt="image-20220325204518286" style="zoom:25%;" />&#x3D;&#x3D;通过样本估计了两个参数，df-2&#x3D;&#x3D;</td>
<td></td>
</tr>
</tbody></table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Long Chen</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">31</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Long Chen</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
